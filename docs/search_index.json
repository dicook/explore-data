[["bivariate-dependencies-and-relationships.html", "Chapter 5 Bivariate dependencies and relationships 5.1 Motivation 5.2 The humble scatterplot 5.3 Exercises", " Chapter 5 Bivariate dependencies and relationships library(tidyverse) ## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ── ## ✓ ggplot2 3.3.5 ✓ purrr 0.3.4 ## ✓ tibble 3.1.3 ✓ dplyr 1.0.7 ## ✓ tidyr 1.1.3 ✓ stringr 1.4.0 ## ✓ readr 2.0.0 ✓ forcats 0.5.1 ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ── ## x dplyr::filter() masks stats::filter() ## x dplyr::lag() masks stats::lag() library(patchwork) library(VGAMdata) ## Loading required package: VGAM ## Loading required package: stats4 ## Loading required package: splines ## ## Attaching package: &#39;VGAM&#39; ## The following object is masked from &#39;package:tidyr&#39;: ## ## fill library(nycflights13) library(ggplot2movies) 5.1 Motivation The story of the galloping horse My own painting: hills Reflection of lemons Green trees Tendency to repeat what other people have reported, or impose prior beliefs. Look again, see with fresh eyes 5.2 The humble scatterplot Scatter plots are glorious. Of all the major chart types, they are by far the most powerful. They allow us to .monash-orange2[quickly understand relationships] that would be nearly impossible to recognize in a table or a different type of chart. … Michael Friendly and Daniel Denis, psychologists and historians of graphics, call the scatter plot the most “generally useful invention in the history of statistical graphics.” Dan Kopf 5.2.1 History Descartes provided the Cartesian coordinate system in the 17\\(^{th}\\) century, with perpendicular lines indicating two axes. It wasn’t until 1832 that the scatterplot appeared, when John Frederick Herschel (Friendly and Denis 2001) plotted position and time of double stars. This is 50 years after bar charts and line charts appeared, used in the work of William Playfair to examine economic data. Kopf argues that The scatter plot, by contrast, proved more useful for scientists, but it clearly is useful for economics today. 5.2.2 Language and terminology The words “correlation” and “association” are NOT interchangeable. In the English language correlation means a mutual relationship or connection between two things. However, the statistic called correlation ONLY describes linear relationships. If the relationship is NOT linear, call use the term association to describe it. Use the term correlated only for linear relationships to avoid confusion related to the statistic.] 5.2.3 Anscombe’s quartet 5.2.4 DatasauRus dozen 5.2.5 Case study 1: olympics data(oly12, package = &quot;VGAMdata&quot;) skimr::skim(oly12) ## Warning in sorted_count(x): Variable contains value(s) of &quot;&quot; that have been ## converted to &quot;empty&quot;. Table 5.1: Data summary Name oly12 Number of rows 10384 Number of columns 14 _______________________ Column type frequency: Date 1 factor 6 numeric 7 ________________________ Group variables None Variable type: Date skim_variable n_missing complete_rate min max median n_unique DOB 6192 0.4 1947-06-01 1997-07-09 1986-09-11 2149 Variable type: factor skim_variable n_missing complete_rate ordered n_unique top_counts Name 0 1 FALSE 10366 Lei: 3, Lin: 3, Ale: 2, Hao: 2 Country 0 1 FALSE 205 Gre: 523, Uni: 518, Rus: 414, Aus: 399 Sex 0 1 FALSE 2 M: 5756, F: 4628 PlaceOB 0 1 FALSE 4108 emp: 2690, Seo: 57, Bud: 54, Mos: 50 Sport 0 1 FALSE 42 Ath: 2119, Swi: 907, Foo: 596, Row: 524 Event 0 1 FALSE 763 Men: 336, Wom: 260, Wom: 210, Men: 206 Variable type: numeric skim_variable n_missing complete_rate mean sd p0 p25 p50 p75 p100 hist Age 0 1.00 26.07 5.44 13.00 22.00 25.00 29.00 71.00 ▆▇▁▁▁ Height 561 0.95 1.77 0.11 1.32 1.69 1.77 1.85 2.21 ▁▃▇▃▁ Weight 1280 0.88 72.85 16.07 36.00 61.00 70.00 81.00 218.00 ▇▆▁▁▁ Gold 0 1.00 0.02 0.14 0.00 0.00 0.00 0.00 2.00 ▇▁▁▁▁ Silver 0 1.00 0.02 0.13 0.00 0.00 0.00 0.00 2.00 ▇▁▁▁▁ Bronze 0 1.00 0.02 0.14 0.00 0.00 0.00 0.00 2.00 ▇▁▁▁▁ Total 0 1.00 0.05 0.25 0.00 0.00 0.00 0.00 5.00 ▇▁▁▁▁ oly12 &lt;- oly12 %&gt;% mutate(Sport = as.character(Sport)) %&gt;% mutate(Sport = ifelse(grepl(&quot;Cycling&quot;, Sport), #&lt;&lt; &quot;Cycling&quot;, Sport)) %&gt;% #&lt;&lt; mutate(Sport = ifelse(grepl(&quot;Gymnastics&quot;, Sport), &quot;Gymnastics&quot;, Sport)) %&gt;% mutate(Sport = ifelse(grepl(&quot;Athletics&quot;, Sport), &quot;Athletics&quot;, Sport)) %&gt;% mutate(Sport = as.factor(Sport)) 5.2.6 Case study 2: movies 5.2.7 Case study 3: cars 5.2.8 Case study 4: soils 5.2.9 Case study 5: COVID 5.2.10 Checking association with permutations transformations to linearise 5.3 Exercises For each of the following scatterplots, of different Olympic athlete’s height and weight identify the visible features, and which is the most surprising. q1a &lt;- oly12 %&gt;% filter(Sport == &quot;Wrestling&quot;, Sex == &quot;F&quot;) %&gt;% ggplot(aes(x=Height, y=Weight)) + geom_point(alpha=0.9, size=3) + ggtitle(&quot;Women&#39;s wrestling&quot;) + theme(aspect.ratio=1) q1b &lt;- oly12 %&gt;% filter(Sport == &quot;Sailing&quot;, Sex == &quot;M&quot;) %&gt;% ggplot(aes(x=Height, y=Weight)) + geom_point(alpha=0.9, size=3) + ggtitle(&quot;Men&#39;s sailing&quot;) + theme(aspect.ratio=1) q1c &lt;- oly12 %&gt;% filter(Sport == &quot;Archery&quot;, Sex == &quot;F&quot;) %&gt;% ggplot(aes(x=Height, y=Weight)) + geom_point(alpha=0.9, size=3) + ggtitle(&quot;Female archery&quot;) + theme(aspect.ratio=1) q1d &lt;- oly12 %&gt;% filter(Sport == &quot;Rowing&quot;, Sex == &quot;F&quot;) %&gt;% ggplot(aes(x=Height, y=Weight)) + geom_point(alpha=0.9, size=3) + ggtitle(&quot;Female rowing&quot;) + theme(aspect.ratio=1) q1a + q1b + q1c + q1d ## Warning: Removed 6 rows containing missing values (geom_point). ## Warning: Removed 7 rows containing missing values (geom_point). ## Warning: Removed 3 rows containing missing values (geom_point). ## Warning: Removed 3 rows containing missing values (geom_point). Guess the correlation between the two variables in each of the previous scatterplots. oly12 %&gt;% filter(Sport == &quot;Wrestling&quot;, Sex == &quot;F&quot;) %&gt;% select(Height, Weight) %&gt;% correlate() oly12 %&gt;% filter(Sport == &quot;Sailing&quot;, Sex == &quot;M&quot;) %&gt;% select(Height, Weight) %&gt;% correlate() oly12 %&gt;% filter(Sport == &quot;Archery&quot;, Sex == &quot;F&quot;) %&gt;% select(Height, Weight) %&gt;% correlate() oly12 %&gt;% filter(Sport == &quot;Rowing&quot;, Sex == &quot;F&quot;) %&gt;% select(Height, Weight) %&gt;% correlate() From the following scatterplot, of diamond size and price, what are the most prominent features? set.seed(344) diamonds_small &lt;- diamonds %&gt;% sample_n(1000) ggplot(diamonds_small, aes(x=carat, y=price)) + geom_point() In the previous plot of diamonds, what transformation would be recommended based on the “circle of transformations?” In the following plot of arrival delay and departure delay of flights into and out of the New York City area, what are the most prominent features? ggplot(flights, aes(x=dep_delay, y=arr_delay)) + geom_point() ## Warning: Removed 9430 rows containing missing values (geom_point). Which of these would be a surprising feature learned from this plot? Why? There are negative departure and arrival delays If a flight has a delay in departure it likely will be delayed on arrival Some flights with negative departure delay have long arrival delays Some flights have long delays Some flights with negative arrival delays have positive departure delays A dominant feature in the plot of average rating by number of ratings of movies in the IMDB database is a barrier, or two barriers, both top and bottom of plot. What is a plausible explanation for this feature? ggplot(movies, aes(x=votes, y=rating)) + geom_point() + scale_y_continuous(&quot;rating&quot;, breaks = seq(0, 10, 2)) As movies become more popular ratings invariably go down There are just very few frequently rated movies and this means it is unlikely to see high values. The lesser rated movies have a lot of variance in their ratings, producing a barrier for the more frequently rated movies. The lesser rated movies have a lot of variance in their ratings, producing a barrier for the more frequently rated movies. The average of many values tends to be unlikely to be at the highest and lowest possible values. References "]]
