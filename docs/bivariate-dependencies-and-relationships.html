<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Bivariate dependencies and relationships | Exploratory Data Analysis in the 21st Century</title>
  <meta name="description" content="This is a book about EDA today." />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Bivariate dependencies and relationships | Exploratory Data Analysis in the 21st Century" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a book about EDA today." />
  <meta name="github-repo" content="https://github.com/dicook/explore-data" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Bivariate dependencies and relationships | Exploratory Data Analysis in the 21st Century" />
  
  <meta name="twitter:description" content="This is a book about EDA today." />
  

<meta name="author" content="Di Cook and Emi Tanaka" />


<meta name="date" content="2023-05-02" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="working-with-a-single-variable.html"/>
<link rel="next" href="going-beyond-two-variables.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>
<link href="libs/font-awesome-animation-1.0/font-awesome-animation-emi.css" rel="stylesheet" />
<script src="libs/fontawesome-5.0.13/js/fontawesome-all.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">This is a book about EDA today. </a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a></li>
<li class="chapter" data-level="2" data-path="what-is-eda.html"><a href="what-is-eda.html"><i class="fa fa-check"></i><b>2</b> What is exploratory data analysis?</a>
<ul>
<li class="chapter" data-level="2.1" data-path="what-is-eda.html"><a href="what-is-eda.html#common-descriptions"><i class="fa fa-check"></i><b>2.1</b> Common descriptions</a></li>
<li class="chapter" data-level="2.2" data-path="what-is-eda.html"><a href="what-is-eda.html#components-of-data-analysis"><i class="fa fa-check"></i><b>2.2</b> Components of data analysis</a></li>
<li class="chapter" data-level="2.3" data-path="what-is-eda.html"><a href="what-is-eda.html#differentiating-eda-from-cda"><i class="fa fa-check"></i><b>2.3</b> Differentiating EDA from CDA</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="what-is-eda.html"><a href="what-is-eda.html#from-the-case-study"><i class="fa fa-check"></i><b>2.3.1</b> From the case study</a></li>
<li class="chapter" data-level="2.3.2" data-path="what-is-eda.html"><a href="what-is-eda.html#eda-approach"><i class="fa fa-check"></i><b>2.3.2</b> EDA approach</a></li>
<li class="chapter" data-level="2.3.3" data-path="what-is-eda.html"><a href="what-is-eda.html#what-we-learned-from-eda"><i class="fa fa-check"></i><b>2.3.3</b> What we learned from EDA</a></li>
<li class="chapter" data-level="2.3.4" data-path="what-is-eda.html"><a href="what-is-eda.html#reality-check"><i class="fa fa-check"></i><b>2.3.4</b> Reality check</a></li>
<li class="chapter" data-level="2.3.5" data-path="what-is-eda.html"><a href="what-is-eda.html#what-is-eda-1"><i class="fa fa-check"></i><b>2.3.5</b> What is EDA?</a></li>
<li class="chapter" data-level="2.3.6" data-path="what-is-eda.html"><a href="what-is-eda.html#isnt-it-data-snooping"><i class="fa fa-check"></i><b>2.3.6</b> Isn’t it data snooping?</a></li>
<li class="chapter" data-level="2.3.7" data-path="what-is-eda.html"><a href="what-is-eda.html#why-arent-there-more-resources-on-eda"><i class="fa fa-check"></i><b>2.3.7</b> Why aren’t there more resources on EDA?</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="what-is-eda.html"><a href="what-is-eda.html#the-origins-of-eda"><i class="fa fa-check"></i><b>2.4</b> The origins of EDA</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="what-is-eda.html"><a href="what-is-eda.html#example-1-stem-and-leaf"><i class="fa fa-check"></i><b>2.4.1</b> Example 1: Stem-and-leaf</a></li>
<li class="chapter" data-level="2.4.2" data-path="what-is-eda.html"><a href="what-is-eda.html#example-1-making-tallies"><i class="fa fa-check"></i><b>2.4.2</b> Example 1: Making tallies</a></li>
<li class="chapter" data-level="2.4.3" data-path="what-is-eda.html"><a href="what-is-eda.html#example-3-boxplots"><i class="fa fa-check"></i><b>2.4.3</b> Example 3: Boxplots</a></li>
<li class="chapter" data-level="2.4.4" data-path="what-is-eda.html"><a href="what-is-eda.html#example-4-easy-re-expression"><i class="fa fa-check"></i><b>2.4.4</b> Example 4: Easy re-expression</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="what-is-eda.html"><a href="what-is-eda.html#exercises"><i class="fa fa-check"></i><b>2.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="initial-data-analysis.html"><a href="initial-data-analysis.html"><i class="fa fa-check"></i><b>3</b> Initial Data Analysis</a>
<ul>
<li class="chapter" data-level="3.1" data-path="initial-data-analysis.html"><a href="initial-data-analysis.html#data-description"><i class="fa fa-check"></i><b>3.1</b> Data description</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="initial-data-analysis.html"><a href="initial-data-analysis.html#checking-the-data-type"><i class="fa fa-check"></i><b>3.1.1</b> Checking the data type</a></li>
<li class="chapter" data-level="3.1.2" data-path="initial-data-analysis.html"><a href="initial-data-analysis.html#checking-the-data-quality"><i class="fa fa-check"></i><b>3.1.2</b> Checking the data quality</a></li>
<li class="chapter" data-level="3.1.3" data-path="initial-data-analysis.html"><a href="initial-data-analysis.html#check-on-data-collection-method"><i class="fa fa-check"></i><b>3.1.3</b> Check on data collection method</a></li>
<li class="chapter" data-level="3.1.4" data-path="initial-data-analysis.html"><a href="initial-data-analysis.html#check-for-experimental-data"><i class="fa fa-check"></i><b>3.1.4</b> Check for experimental data</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="initial-data-analysis.html"><a href="initial-data-analysis.html#model-formulation"><i class="fa fa-check"></i><b>3.2</b> Model formulation</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="initial-data-analysis.html"><a href="initial-data-analysis.html#review-linear-models-in-r"><i class="fa fa-check"></i><b>3.2.1</b> Review: Linear models in R</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="initial-data-analysis.html"><a href="initial-data-analysis.html#model-formulation-1"><i class="fa fa-check"></i><b>3.3</b> Model formulation</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="initial-data-analysis.html"><a href="initial-data-analysis.html#experimental-design"><i class="fa fa-check"></i><b>3.3.1</b> Experimental Design</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="initial-data-analysis.html"><a href="initial-data-analysis.html#summary"><i class="fa fa-check"></i><b>3.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="working-with-a-single-variable.html"><a href="working-with-a-single-variable.html"><i class="fa fa-check"></i><b>4</b> Working with a single variable</a>
<ul>
<li class="chapter" data-level="4.1" data-path="working-with-a-single-variable.html"><a href="working-with-a-single-variable.html#possible-features-of-continuous-variables"><i class="fa fa-check"></i><b>4.1</b> Possible features of continuous variables</a></li>
<li class="chapter" data-level="4.2" data-path="working-with-a-single-variable.html"><a href="working-with-a-single-variable.html#numerical-features-of-a-single-continuous-variables"><i class="fa fa-check"></i><b>4.2</b> Numerical features of a single continuous variables</a></li>
<li class="chapter" data-level="4.3" data-path="working-with-a-single-variable.html"><a href="working-with-a-single-variable.html#outliers"><i class="fa fa-check"></i><b>4.3</b> Outliers</a></li>
<li class="chapter" data-level="4.4" data-path="working-with-a-single-variable.html"><a href="working-with-a-single-variable.html#closer-look-at-the-boxplot"><i class="fa fa-check"></i><b>4.4</b> Closer look at the <em>boxplot</em></a></li>
<li class="chapter" data-level="4.5" data-path="working-with-a-single-variable.html"><a href="working-with-a-single-variable.html#robust-statistics-measure-of-central-tendency"><i class="fa fa-check"></i><b>4.5</b> Robust statistics: measure of central tendency</a></li>
<li class="chapter" data-level="4.6" data-path="working-with-a-single-variable.html"><a href="working-with-a-single-variable.html#robust-statistics-measure-of-dispersion"><i class="fa fa-check"></i><b>4.6</b> Robust statistics: measure of dispersion</a></li>
<li class="chapter" data-level="4.7" data-path="working-with-a-single-variable.html"><a href="working-with-a-single-variable.html#transformations"><i class="fa fa-check"></i><b>4.7</b> Transformations</a></li>
<li class="chapter" data-level="4.8" data-path="working-with-a-single-variable.html"><a href="working-with-a-single-variable.html#categorical-variables"><i class="fa fa-check"></i><b>4.8</b> Categorical variables</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="working-with-a-single-variable.html"><a href="working-with-a-single-variable.html#categorical-factors-un-r"><i class="fa fa-check"></i><b>4.8.1</b> Categorical factors un R</a></li>
<li class="chapter" data-level="4.8.2" data-path="working-with-a-single-variable.html"><a href="working-with-a-single-variable.html#numerical-factors-in-r"><i class="fa fa-check"></i><b>4.8.2</b> Numerical factors in R</a></li>
<li class="chapter" data-level="4.8.3" data-path="working-with-a-single-variable.html"><a href="working-with-a-single-variable.html#example-german-bundestag-election-2009"><i class="fa fa-check"></i><b>4.8.3</b> Example: German Bundestag Election 2009</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="working-with-a-single-variable.html"><a href="working-with-a-single-variable.html#order-nominal-variables-meaningfully"><i class="fa fa-check"></i><b>4.9</b> Order nominal variables meaningfully</a></li>
<li class="chapter" data-level="4.10" data-path="working-with-a-single-variable.html"><a href="working-with-a-single-variable.html#example-aspirin-use-after-heart-attack"><i class="fa fa-check"></i><b>4.10</b> Example: Aspirin use after heart attack</a></li>
<li class="chapter" data-level="4.11" data-path="working-with-a-single-variable.html"><a href="working-with-a-single-variable.html#consider-combining-factor-levels-with-low-frequencies"><i class="fa fa-check"></i><b>4.11</b> Consider combining factor levels with low frequencies</a></li>
<li class="chapter" data-level="4.12" data-path="working-with-a-single-variable.html"><a href="working-with-a-single-variable.html#anorexia"><i class="fa fa-check"></i><b>4.12</b> Anorexia</a></li>
<li class="chapter" data-level="4.13" data-path="working-with-a-single-variable.html"><a href="working-with-a-single-variable.html#titanic"><i class="fa fa-check"></i><b>4.13</b> Titanic</a></li>
<li class="chapter" data-level="4.14" data-path="working-with-a-single-variable.html"><a href="working-with-a-single-variable.html#coloring-bars"><i class="fa fa-check"></i><b>4.14</b> Coloring bars</a></li>
<li class="chapter" data-level="4.15" data-path="working-with-a-single-variable.html"><a href="working-with-a-single-variable.html#opinion-poll-in-ireland-aug-2013"><i class="fa fa-check"></i><b>4.15</b> Opinion poll in Ireland Aug 2013</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="bivariate-dependencies-and-relationships.html"><a href="bivariate-dependencies-and-relationships.html"><i class="fa fa-check"></i><b>5</b> Bivariate dependencies and relationships</a>
<ul>
<li class="chapter" data-level="5.1" data-path="bivariate-dependencies-and-relationships.html"><a href="bivariate-dependencies-and-relationships.html#motivation"><i class="fa fa-check"></i><b>5.1</b> Motivation</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="bivariate-dependencies-and-relationships.html"><a href="bivariate-dependencies-and-relationships.html#history"><i class="fa fa-check"></i><b>5.1.1</b> History</a></li>
<li class="chapter" data-level="5.1.2" data-path="bivariate-dependencies-and-relationships.html"><a href="bivariate-dependencies-and-relationships.html#language-and-terminology"><i class="fa fa-check"></i><b>5.1.2</b> Language and terminology</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="bivariate-dependencies-and-relationships.html"><a href="bivariate-dependencies-and-relationships.html#common-features-and-their-names"><i class="fa fa-check"></i><b>5.2</b> Common features and their names</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="bivariate-dependencies-and-relationships.html"><a href="bivariate-dependencies-and-relationships.html#anscombes-quartet"><i class="fa fa-check"></i><b>5.2.1</b> Anscombe’s quartet</a></li>
<li class="chapter" data-level="5.2.2" data-path="bivariate-dependencies-and-relationships.html"><a href="bivariate-dependencies-and-relationships.html#datasaurus-dozen"><i class="fa fa-check"></i><b>5.2.2</b> DatasauRus dozen</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="bivariate-dependencies-and-relationships.html"><a href="bivariate-dependencies-and-relationships.html#case-study-1-olympics"><i class="fa fa-check"></i><b>5.3</b> Case study 1: olympics</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="bivariate-dependencies-and-relationships.html"><a href="bivariate-dependencies-and-relationships.html#how-many-athletes-in-the-different-sports"><i class="fa fa-check"></i><b>5.3.1</b> How many athletes in the different sports?</a></li>
<li class="chapter" data-level="5.3.2" data-path="bivariate-dependencies-and-relationships.html"><a href="bivariate-dependencies-and-relationships.html#consolidate-factor-levels"><i class="fa fa-check"></i><b>5.3.2</b> Consolidate factor levels</a></li>
<li class="chapter" data-level="5.3.3" data-path="bivariate-dependencies-and-relationships.html"><a href="bivariate-dependencies-and-relationships.html#split-by-sport"><i class="fa fa-check"></i><b>5.3.3</b> Split by sport</a></li>
<li class="chapter" data-level="5.3.4" data-path="bivariate-dependencies-and-relationships.html"><a href="bivariate-dependencies-and-relationships.html#remove-missings-add-colour-for-sex"><i class="fa fa-check"></i><b>5.3.4</b> Remove missings, add colour for sex</a></li>
<li class="chapter" data-level="5.3.5" data-path="bivariate-dependencies-and-relationships.html"><a href="bivariate-dependencies-and-relationships.html#comparing-association"><i class="fa fa-check"></i><b>5.3.5</b> Comparing association</a></li>
<li class="chapter" data-level="5.3.6" data-path="bivariate-dependencies-and-relationships.html"><a href="bivariate-dependencies-and-relationships.html#comparing-variability"><i class="fa fa-check"></i><b>5.3.6</b> Comparing variability</a></li>
<li class="chapter" data-level="5.3.7" data-path="bivariate-dependencies-and-relationships.html"><a href="bivariate-dependencies-and-relationships.html#summary-1"><i class="fa fa-check"></i><b>5.3.7</b> Summary</a></li>
<li class="chapter" data-level="5.3.8" data-path="bivariate-dependencies-and-relationships.html"><a href="bivariate-dependencies-and-relationships.html#scatterplot-modifications-and-purpose"><i class="fa fa-check"></i><b>5.3.8</b> Scatterplot modifications and purpose</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="bivariate-dependencies-and-relationships.html"><a href="bivariate-dependencies-and-relationships.html#numerical-measures-of-association"><i class="fa fa-check"></i><b>5.4</b> Numerical measures of association</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="bivariate-dependencies-and-relationships.html"><a href="bivariate-dependencies-and-relationships.html#correlation"><i class="fa fa-check"></i><b>5.4.1</b> Correlation</a></li>
<li class="chapter" data-level="5.4.2" data-path="bivariate-dependencies-and-relationships.html"><a href="bivariate-dependencies-and-relationships.html#peceiving-correlation"><i class="fa fa-check"></i><b>5.4.2</b> Peceiving correlation</a></li>
<li class="chapter" data-level="5.4.3" data-path="bivariate-dependencies-and-relationships.html"><a href="bivariate-dependencies-and-relationships.html#robust-correlation-measures"><i class="fa fa-check"></i><b>5.4.3</b> Robust correlation measures</a></li>
<li class="chapter" data-level="5.4.4" data-path="bivariate-dependencies-and-relationships.html"><a href="bivariate-dependencies-and-relationships.html#robust-correlation-measures-1"><i class="fa fa-check"></i><b>5.4.4</b> Robust correlation measures</a></li>
<li class="chapter" data-level="5.4.5" data-path="bivariate-dependencies-and-relationships.html"><a href="bivariate-dependencies-and-relationships.html#comparison-of-correlation-measures"><i class="fa fa-check"></i><b>5.4.5</b> Comparison of correlation measures</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="bivariate-dependencies-and-relationships.html"><a href="bivariate-dependencies-and-relationships.html#case-study-2-movies"><i class="fa fa-check"></i><b>5.5</b> Case study 2: movies</a></li>
<li class="chapter" data-level="5.6" data-path="bivariate-dependencies-and-relationships.html"><a href="bivariate-dependencies-and-relationships.html#case-study-3-cars"><i class="fa fa-check"></i><b>5.6</b> Case study 3: cars</a></li>
<li class="chapter" data-level="5.7" data-path="bivariate-dependencies-and-relationships.html"><a href="bivariate-dependencies-and-relationships.html#circle-of-transformations-for-linearising"><i class="fa fa-check"></i><b>5.7</b> Circle of transformations for linearising</a></li>
<li class="chapter" data-level="5.8" data-path="bivariate-dependencies-and-relationships.html"><a href="bivariate-dependencies-and-relationships.html#case-study-4-soils"><i class="fa fa-check"></i><b>5.8</b> Case study 4: soils</a></li>
<li class="chapter" data-level="5.9" data-path="bivariate-dependencies-and-relationships.html"><a href="bivariate-dependencies-and-relationships.html#case-study-5-covid"><i class="fa fa-check"></i><b>5.9</b> Case study 5: COVID</a></li>
<li class="chapter" data-level="5.10" data-path="bivariate-dependencies-and-relationships.html"><a href="bivariate-dependencies-and-relationships.html#beyond-quantitative-variables"><i class="fa fa-check"></i><b>5.10</b> Beyond quantitative variables</a></li>
<li class="chapter" data-level="5.11" data-path="bivariate-dependencies-and-relationships.html"><a href="bivariate-dependencies-and-relationships.html#simpsons-paradox"><i class="fa fa-check"></i><b>5.11</b> Simpsons paradox</a></li>
<li class="chapter" data-level="5.12" data-path="bivariate-dependencies-and-relationships.html"><a href="bivariate-dependencies-and-relationships.html#spurious-association"><i class="fa fa-check"></i><b>5.12</b> Spurious association</a></li>
<li class="chapter" data-level="5.13" data-path="bivariate-dependencies-and-relationships.html"><a href="bivariate-dependencies-and-relationships.html#checking-association-with-permutations"><i class="fa fa-check"></i><b>5.13</b> Checking association with permutations</a></li>
<li class="chapter" data-level="5.14" data-path="bivariate-dependencies-and-relationships.html"><a href="bivariate-dependencies-and-relationships.html#resources"><i class="fa fa-check"></i><b>5.14</b> Resources</a></li>
<li class="chapter" data-level="5.15" data-path="bivariate-dependencies-and-relationships.html"><a href="bivariate-dependencies-and-relationships.html#exercises-1"><i class="fa fa-check"></i><b>5.15</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="going-beyond-two-variables.html"><a href="going-beyond-two-variables.html"><i class="fa fa-check"></i><b>6</b> Going beyond two variables</a></li>
<li class="chapter" data-level="7" data-path="making-comparisons-between-groups-and-strata.html"><a href="making-comparisons-between-groups-and-strata.html"><i class="fa fa-check"></i><b>7</b> Making comparisons between groups and strata</a>
<ul>
<li class="chapter" data-level="7.1" data-path="making-comparisons-between-groups-and-strata.html"><a href="making-comparisons-between-groups-and-strata.html#pest-resistance-maize"><i class="fa fa-check"></i><b>7.1</b> Pest resistance maize</a></li>
<li class="chapter" data-level="7.2" data-path="making-comparisons-between-groups-and-strata.html"><a href="making-comparisons-between-groups-and-strata.html#maize-kernels"><i class="fa fa-check"></i><b>7.2</b> Maize kernels</a></li>
<li class="chapter" data-level="7.3" data-path="making-comparisons-between-groups-and-strata.html"><a href="making-comparisons-between-groups-and-strata.html#comparing-like-with-like"><i class="fa fa-check"></i><b>7.3</b> Comparing like-with-like</a></li>
<li class="chapter" data-level="7.4" data-path="making-comparisons-between-groups-and-strata.html"><a href="making-comparisons-between-groups-and-strata.html#multi-environment-soybean-trial"><i class="fa fa-check"></i><b>7.4</b> Multi-environment soybean trial</a></li>
<li class="chapter" data-level="7.5" data-path="making-comparisons-between-groups-and-strata.html"><a href="making-comparisons-between-groups-and-strata.html#types-of-comparison"><i class="fa fa-check"></i><b>7.5</b> Types of comparison</a></li>
<li class="chapter" data-level="7.6" data-path="making-comparisons-between-groups-and-strata.html"><a href="making-comparisons-between-groups-and-strata.html#weight-of-calves-with-different-diets"><i class="fa fa-check"></i><b>7.6</b> Weight of calves with different diets</a></li>
<li class="chapter" data-level="7.7" data-path="making-comparisons-between-groups-and-strata.html"><a href="making-comparisons-between-groups-and-strata.html#swiss-bank-notes"><i class="fa fa-check"></i><b>7.7</b> Swiss bank notes</a></li>
<li class="chapter" data-level="7.8" data-path="making-comparisons-between-groups-and-strata.html"><a href="making-comparisons-between-groups-and-strata.html#comparing-graphically"><i class="fa fa-check"></i><b>7.8</b> Comparing graphically</a></li>
<li class="chapter" data-level="7.9" data-path="making-comparisons-between-groups-and-strata.html"><a href="making-comparisons-between-groups-and-strata.html#barley-yield"><i class="fa fa-check"></i><b>7.9</b> Barley Yield</a></li>
<li class="chapter" data-level="7.10" data-path="making-comparisons-between-groups-and-strata.html"><a href="making-comparisons-between-groups-and-strata.html#olive-oils"><i class="fa fa-check"></i><b>7.10</b> Olive oils</a></li>
<li class="chapter" data-level="7.11" data-path="making-comparisons-between-groups-and-strata.html"><a href="making-comparisons-between-groups-and-strata.html#england-and-east-indies-trade-data"><i class="fa fa-check"></i><b>7.11</b> England and East Indies trade data</a></li>
<li class="chapter" data-level="7.12" data-path="making-comparisons-between-groups-and-strata.html"><a href="making-comparisons-between-groups-and-strata.html#melbournes-daily-maximum-temperature"><i class="fa fa-check"></i><b>7.12</b> Melbourne’s daily maximum temperature</a></li>
<li class="chapter" data-level="7.13" data-path="making-comparisons-between-groups-and-strata.html"><a href="making-comparisons-between-groups-and-strata.html#modelling-and-testing-for-comparisons"><i class="fa fa-check"></i><b>7.13</b> Modelling and testing for comparisons</a></li>
<li class="chapter" data-level="7.14" data-path="making-comparisons-between-groups-and-strata.html"><a href="making-comparisons-between-groups-and-strata.html#pest-resistance-maize-1"><i class="fa fa-check"></i><b>7.14</b> Pest resistance maize</a></li>
<li class="chapter" data-level="7.15" data-path="making-comparisons-between-groups-and-strata.html"><a href="making-comparisons-between-groups-and-strata.html#two-sample-parametric-tests-t-test"><i class="fa fa-check"></i><b>7.15</b> Two-sample parametric tests: <span class="math inline">\(t\)</span>-test</a></li>
<li class="chapter" data-level="7.16" data-path="making-comparisons-between-groups-and-strata.html"><a href="making-comparisons-between-groups-and-strata.html#confidence-interval-for-two-sample-difference"><i class="fa fa-check"></i><b>7.16</b> Confidence interval for two sample difference</a></li>
<li class="chapter" data-level="7.17" data-path="making-comparisons-between-groups-and-strata.html"><a href="making-comparisons-between-groups-and-strata.html#two-sample-non-parametric-tests"><i class="fa fa-check"></i><b>7.17</b> Two sample non-parametric tests</a>
<ul>
<li class="chapter" data-level="7.17.1" data-path="making-comparisons-between-groups-and-strata.html"><a href="making-comparisons-between-groups-and-strata.html#wilcoxon-rank-sum-test"><i class="fa fa-check"></i><b>7.17.1</b> Wilcoxon rank-sum test</a></li>
</ul></li>
<li class="chapter" data-level="7.18" data-path="making-comparisons-between-groups-and-strata.html"><a href="making-comparisons-between-groups-and-strata.html#weight-gain-of-calves"><i class="fa fa-check"></i><b>7.18</b> Weight gain of calves</a>
<ul>
<li class="chapter" data-level="7.18.1" data-path="making-comparisons-between-groups-and-strata.html"><a href="making-comparisons-between-groups-and-strata.html#weight-gain-of-calves-1"><i class="fa fa-check"></i><b>7.18.1</b> Weight gain of calves</a></li>
</ul></li>
<li class="chapter" data-level="7.19" data-path="making-comparisons-between-groups-and-strata.html"><a href="making-comparisons-between-groups-and-strata.html#soil-nitrogen"><i class="fa fa-check"></i><b>7.19</b> Soil nitrogen</a></li>
<li class="chapter" data-level="7.20" data-path="making-comparisons-between-groups-and-strata.html"><a href="making-comparisons-between-groups-and-strata.html#controlling-the-family-wise-error-rate"><i class="fa fa-check"></i><b>7.20</b> Controlling the family-wise error rate</a></li>
<li class="chapter" data-level="7.21" data-path="making-comparisons-between-groups-and-strata.html"><a href="making-comparisons-between-groups-and-strata.html#unadjusted"><i class="fa fa-check"></i><b>7.21</b> Unadjusted</a></li>
<li class="chapter" data-level="7.22" data-path="making-comparisons-between-groups-and-strata.html"><a href="making-comparisons-between-groups-and-strata.html#bonferonni-adjustment"><i class="fa fa-check"></i><b>7.22</b> Bonferonni adjustment</a></li>
<li class="chapter" data-level="7.23" data-path="making-comparisons-between-groups-and-strata.html"><a href="making-comparisons-between-groups-and-strata.html#mystery-data"><i class="fa fa-check"></i><b>7.23</b> Mystery data</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="sculpting-data-using-models.html"><a href="sculpting-data-using-models.html"><i class="fa fa-check"></i><b>8</b> Sculpting data using models</a>
<ul>
<li class="chapter" data-level="8.1" data-path="sculpting-data-using-models.html"><a href="sculpting-data-using-models.html#parametric-regression"><i class="fa fa-check"></i><b>8.1</b> Parametric regression</a></li>
<li class="chapter" data-level="8.2" data-path="sculpting-data-using-models.html"><a href="sculpting-data-using-models.html#example"><i class="fa fa-check"></i><b>8.2</b> Example</a></li>
<li class="chapter" data-level="8.3" data-path="sculpting-data-using-models.html"><a href="sculpting-data-using-models.html#simulating-data-from-parametric-models"><i class="fa fa-check"></i><b>8.3</b> Simulating data from parametric models</a></li>
<li class="chapter" data-level="8.4" data-path="sculpting-data-using-models.html"><a href="sculpting-data-using-models.html#logistic-regression"><i class="fa fa-check"></i><b>8.4</b> Logistic regression</a></li>
<li class="chapter" data-level="8.5" data-path="sculpting-data-using-models.html"><a href="sculpting-data-using-models.html#menarche"><i class="fa fa-check"></i><b>8.5</b> Menarche</a></li>
<li class="chapter" data-level="8.6" data-path="sculpting-data-using-models.html"><a href="sculpting-data-using-models.html#simulating-data-from-logistic-regression"><i class="fa fa-check"></i><b>8.6</b> Simulating data from logistic regression</a></li>
<li class="chapter" data-level="8.7" data-path="sculpting-data-using-models.html"><a href="sculpting-data-using-models.html#diagnostics-for-logistic-regression-models"><i class="fa fa-check"></i><b>8.7</b> Diagnostics for logistic regression models</a></li>
<li class="chapter" data-level="8.8" data-path="sculpting-data-using-models.html"><a href="sculpting-data-using-models.html#diagnostics-for-linear-models"><i class="fa fa-check"></i><b>8.8</b> Diagnostics for linear models</a></li>
<li class="chapter" data-level="8.9" data-path="sculpting-data-using-models.html"><a href="sculpting-data-using-models.html#assessing-a1-eepsilon_i-0-for-i1ldotsn"><i class="fa fa-check"></i><b>8.9</b> Assessing (A1) <span class="math inline">\(E(\epsilon_i) = 0\)</span> for <span class="math inline">\(i=1,\ldots,n\)</span></a></li>
<li class="chapter" data-level="8.10" data-path="sculpting-data-using-models.html"><a href="sculpting-data-using-models.html#assessing-a2-a3"><i class="fa fa-check"></i><b>8.10</b> Assessing (A2)-(A3)</a>
<ul>
<li class="chapter" data-level="8.10.1" data-path="sculpting-data-using-models.html"><a href="sculpting-data-using-models.html#in-r"><i class="fa fa-check"></i><b>8.10.1</b> In R</a></li>
</ul></li>
<li class="chapter" data-level="8.11" data-path="sculpting-data-using-models.html"><a href="sculpting-data-using-models.html#examining-the-simulated-data-further"><i class="fa fa-check"></i><b>8.11</b> Examining the simulated data further</a></li>
<li class="chapter" data-level="8.12" data-path="sculpting-data-using-models.html"><a href="sculpting-data-using-models.html#revisiting-outliers"><i class="fa fa-check"></i><b>8.12</b> Revisiting outliers</a></li>
<li class="chapter" data-level="8.13" data-path="sculpting-data-using-models.html"><a href="sculpting-data-using-models.html#pop-quiz"><i class="fa fa-check"></i><b>8.13</b> Pop Quiz</a></li>
<li class="chapter" data-level="8.14" data-path="sculpting-data-using-models.html"><a href="sculpting-data-using-models.html#outlying-values"><i class="fa fa-check"></i><b>8.14</b> Outlying values</a></li>
<li class="chapter" data-level="8.15" data-path="sculpting-data-using-models.html"><a href="sculpting-data-using-models.html#leverage"><i class="fa fa-check"></i><b>8.15</b> Leverage</a></li>
<li class="chapter" data-level="8.16" data-path="sculpting-data-using-models.html"><a href="sculpting-data-using-models.html#studentized-residuals"><i class="fa fa-check"></i><b>8.16</b> Studentized residuals</a></li>
<li class="chapter" data-level="8.17" data-path="sculpting-data-using-models.html"><a href="sculpting-data-using-models.html#cooks-distance"><i class="fa fa-check"></i><b>8.17</b> Cook’s distance</a></li>
<li class="chapter" data-level="8.18" data-path="sculpting-data-using-models.html"><a href="sculpting-data-using-models.html#social-media-marketing"><i class="fa fa-check"></i><b>8.18</b> Social media marketing</a></li>
<li class="chapter" data-level="8.19" data-path="sculpting-data-using-models.html"><a href="sculpting-data-using-models.html#extracting-values-from-models-in-r"><i class="fa fa-check"></i><b>8.19</b> Extracting values from models in R</a></li>
<li class="chapter" data-level="8.20" data-path="sculpting-data-using-models.html"><a href="sculpting-data-using-models.html#non-parametric-regression"><i class="fa fa-check"></i><b>8.20</b> Non-parametric regression</a>
<ul>
<li class="chapter" data-level="8.20.1" data-path="sculpting-data-using-models.html"><a href="sculpting-data-using-models.html#loess"><i class="fa fa-check"></i><b>8.20.1</b> LOESS</a></li>
</ul></li>
<li class="chapter" data-level="8.21" data-path="sculpting-data-using-models.html"><a href="sculpting-data-using-models.html#how-span-changes-the-loess-fit"><i class="fa fa-check"></i><b>8.21</b> How <code>span</code> changes the loess fit</a></li>
<li class="chapter" data-level="8.22" data-path="sculpting-data-using-models.html"><a href="sculpting-data-using-models.html#how-loess-works"><i class="fa fa-check"></i><b>8.22</b> How <code>loess</code> works</a></li>
<li class="chapter" data-level="8.23" data-path="sculpting-data-using-models.html"><a href="sculpting-data-using-models.html#us-economic-time-series"><i class="fa fa-check"></i><b>8.23</b> US economic time series</a></li>
<li class="chapter" data-level="8.24" data-path="sculpting-data-using-models.html"><a href="sculpting-data-using-models.html#how-to-fit-loess-curves-in-r"><i class="fa fa-check"></i><b>8.24</b> How to fit LOESS curves in R?</a>
<ul>
<li class="chapter" data-level="8.24.1" data-path="sculpting-data-using-models.html"><a href="sculpting-data-using-models.html#model-fitting"><i class="fa fa-check"></i><b>8.24.1</b> Model fitting</a></li>
<li class="chapter" data-level="8.24.2" data-path="sculpting-data-using-models.html"><a href="sculpting-data-using-models.html#showing-it-on-the-plot"><i class="fa fa-check"></i><b>8.24.2</b> Showing it on the plot</a></li>
</ul></li>
<li class="chapter" data-level="8.25" data-path="sculpting-data-using-models.html"><a href="sculpting-data-using-models.html#why-non-parametric-regression"><i class="fa fa-check"></i><b>8.25</b> Why non-parametric regression?</a></li>
<li class="chapter" data-level="8.26" data-path="sculpting-data-using-models.html"><a href="sculpting-data-using-models.html#bluegills"><i class="fa fa-check"></i><b>8.26</b> Bluegills</a></li>
<li class="chapter" data-level="8.27" data-path="sculpting-data-using-models.html"><a href="sculpting-data-using-models.html#soil-resistivity-in-a-field"><i class="fa fa-check"></i><b>8.27</b> Soil resistivity in a field</a></li>
<li class="chapter" data-level="8.28" data-path="sculpting-data-using-models.html"><a href="sculpting-data-using-models.html#conditioning-plots-coplots"><i class="fa fa-check"></i><b>8.28</b> Conditioning plots (Coplots)</a></li>
<li class="chapter" data-level="8.29" data-path="sculpting-data-using-models.html"><a href="sculpting-data-using-models.html#coplots-via-ggplot2"><i class="fa fa-check"></i><b>8.29</b> Coplots via <code>ggplot2</code></a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="exploring-data-having-a-space-and-time-context.html"><a href="exploring-data-having-a-space-and-time-context.html"><i class="fa fa-check"></i><b>9</b> Exploring data having a space and time context</a></li>
<li class="chapter" data-level="10" data-path="is-what-you-see-really-there.html"><a href="is-what-you-see-really-there.html"><i class="fa fa-check"></i><b>10</b> Is what you see really there?</a>
<ul>
<li class="chapter" data-level="10.1" data-path="is-what-you-see-really-there.html"><a href="is-what-you-see-really-there.html#revisiting-hypothesis-testing"><i class="fa fa-check"></i><b>10.1</b> Revisiting hypothesis testing</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="is-what-you-see-really-there.html"><a href="is-what-you-see-really-there.html#testing-coin-bias"><i class="fa fa-check"></i><b>10.1.1</b> Testing coin bias</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="is-what-you-see-really-there.html"><a href="is-what-you-see-really-there.html#frequentist-hypotheses-testing-framework"><i class="fa fa-check"></i><b>10.2</b> (Frequentist) hypotheses testing framework</a></li>
<li class="chapter" data-level="10.3" data-path="is-what-you-see-really-there.html"><a href="is-what-you-see-really-there.html#judicial-system"><i class="fa fa-check"></i><b>10.3</b> Judicial system</a></li>
<li class="chapter" data-level="10.4" data-path="is-what-you-see-really-there.html"><a href="is-what-you-see-really-there.html#visual-inference"><i class="fa fa-check"></i><b>10.4</b> Visual inference</a></li>
<li class="chapter" data-level="10.5" data-path="is-what-you-see-really-there.html"><a href="is-what-you-see-really-there.html#visual-inference-more-formally"><i class="fa fa-check"></i><b>10.5</b> Visual inference more formally</a></li>
<li class="chapter" data-level="10.6" data-path="is-what-you-see-really-there.html"><a href="is-what-you-see-really-there.html#uniformity-trial-of-peanuts"><i class="fa fa-check"></i><b>10.6</b> Uniformity trial of peanuts</a></li>
<li class="chapter" data-level="10.7" data-path="is-what-you-see-really-there.html"><a href="is-what-you-see-really-there.html#statistical-significance-and-practical-significance"><i class="fa fa-check"></i><b>10.7</b> Statistical significance and practical significance</a></li>
<li class="chapter" data-level="10.8" data-path="is-what-you-see-really-there.html"><a href="is-what-you-see-really-there.html#statistical-significance-of-the-data-plot"><i class="fa fa-check"></i><b>10.8</b> Statistical significance of the data plot</a></li>
<li class="chapter" data-level="10.9" data-path="is-what-you-see-really-there.html"><a href="is-what-you-see-really-there.html#lineup-of-small-effect-difference"><i class="fa fa-check"></i><b>10.9</b> Lineup of small effect difference</a></li>
<li class="chapter" data-level="10.10" data-path="is-what-you-see-really-there.html"><a href="is-what-you-see-really-there.html#some-considerations-in-visual-inference"><i class="fa fa-check"></i><b>10.10</b> Some considerations in visual inference</a></li>
<li class="chapter" data-level="10.11" data-path="is-what-you-see-really-there.html"><a href="is-what-you-see-really-there.html#visual-inference-with-the-nullabor"><i class="fa fa-check"></i><b>10.11</b> Visual inference with the <code>nullabor</code> 📦</a></li>
<li class="chapter" data-level="10.12" data-path="is-what-you-see-really-there.html"><a href="is-what-you-see-really-there.html#potato-scab-infection"><i class="fa fa-check"></i><b>10.12</b> Potato scab infection</a></li>
<li class="chapter" data-level="10.13" data-path="is-what-you-see-really-there.html"><a href="is-what-you-see-really-there.html#black-cherry-trees"><i class="fa fa-check"></i><b>10.13</b> Black Cherry Trees</a></li>
<li class="chapter" data-level="10.14" data-path="is-what-you-see-really-there.html"><a href="is-what-you-see-really-there.html#temperatures-of-stars"><i class="fa fa-check"></i><b>10.14</b> Temperatures of stars</a></li>
<li class="chapter" data-level="10.15" data-path="is-what-you-see-really-there.html"><a href="is-what-you-see-really-there.html#foreign-exchange-rate"><i class="fa fa-check"></i><b>10.15</b> Foreign exchange rate</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="final-words.html"><a href="final-words.html"><i class="fa fa-check"></i><b>11</b> Final words</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href= https://github.com/dicook/exploratory-data-analysis-in-the-21st-century" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Exploratory Data Analysis in the 21st Century</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="bivariate-dependencies-and-relationships" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> Bivariate dependencies and relationships<a href="bivariate-dependencies-and-relationships.html#bivariate-dependencies-and-relationships" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="motivation" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Motivation<a href="bivariate-dependencies-and-relationships.html#motivation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!-- The story of the galloping horse

- My own painting: hills 
- Reflection of lemons
- Green trees

Tendency to repeat what other people have reported, or impose prior beliefs. 

Look again, see with fresh eyes

## The humble scatterplot
-->
<blockquote>
<p>Scatter plots are glorious. Of all the major chart types, they are by far the most powerful. They allow us to .monash-orange2[quickly understand relationships] that would be nearly impossible to recognize in a table or a different type of chart. … Michael Friendly and Daniel Denis, psychologists and historians of graphics, call the scatter plot the most “generally useful invention in the history of statistical graphics.” <a href="https://qz.com/1235712/the-origins-of-the-scatter-plot-data-visualizations-greatest-invention/">Dan Kopf</a></p>
</blockquote>
<div class="info">
<p>Scatterplots are the natural plot to make to explore association between two <strong>continuous</strong> (quantitative or numeric) variables].</p>
</div>
<p>They are not just for linear relationships but are useful for examining nonlinear patterns, clustering and outliers.</p>
<p>We also can think about scatterplots in terms of statistical distributions: if a histogram shows a marginal distribution, a scatterplot allows us to examine the bivariate distribution of a sample.</p>
<div id="history" class="section level3 hasAnchor" number="5.1.1">
<h3><span class="header-section-number">5.1.1</span> History<a href="bivariate-dependencies-and-relationships.html#history" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Descartes provided the Cartesian coordinate system in the 17<span class="math inline">\(^{th}\)</span> century, with perpendicular lines indicating two axes.</p>
<p>It wasn’t until 1832 that the scatterplot appeared, when <a href="http://www.datavis.ca/milestones/index.php?group=1800%2B">John Frederick Herschel</a> <span class="citation">(<a href="#ref-friendly_denis" role="doc-biblioref">Friendly and Denis 2001</a>)</span> plotted position and time of double stars.
This is 50 years after <a href="http://www.datavis.ca/milestones/index.php?group=1700s">bar charts and line charts</a> appeared, used in the work of William Playfair to examine economic data. Kopf argues that <em>The scatter plot, by contrast, proved more useful for scientists</em>, but it clearly is useful for economics today.</p>
</div>
<div id="language-and-terminology" class="section level3 hasAnchor" number="5.1.2">
<h3><span class="header-section-number">5.1.2</span> Language and terminology<a href="bivariate-dependencies-and-relationships.html#language-and-terminology" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The words “correlation” and “association” are NOT interchangeable. In the English language correlation means a mutual relationship or connection between two things. However, the statistic called correlation ONLY describes linear relationships.</p>
<div class="info">
<p>If the relationship is NOT linear, call use the term association to describe it. Use the term correlated only for linear relationships to avoid confusion related to the statistic.]</p>
</div>
</div>
</div>
<div id="common-features-and-their-names" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Common features and their names<a href="bivariate-dependencies-and-relationships.html#common-features-and-their-names" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Feature
</th>
<th style="text-align:left;">
Example
</th>
<th style="text-align:left;">
Description
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
positive trend
</td>
<td style="text-align:left;">
<img src="https://github.com/dicook/explore-data/blob/master/_bookdown_files/eda-book_files/figure-html/scatterplots-1.png" height="54px">
</td>
<td style="text-align:left;">
Low value corresponds to low value, and high to high.
</td>
</tr>
<tr>
<td style="text-align:left;">
negative trend
</td>
<td style="text-align:left;">
<img src="https://github.com/dicook/explore-data/blob/master/_bookdown_files/eda-book_files/figure-html/scatterplots-2.png" height="54px">
</td>
<td style="text-align:left;">
Low value corresponds to high value, and high to low.
</td>
</tr>
<tr>
<td style="text-align:left;">
no trend
</td>
<td style="text-align:left;">
<img src="https://github.com/dicook/explore-data/blob/master/_bookdown_files/eda-book_files/figure-html/scatterplots-3.png" height="54px">
</td>
<td style="text-align:left;">
No relationship
</td>
</tr>
<tr>
<td style="text-align:left;">
strong
</td>
<td style="text-align:left;">
<img src="https://github.com/dicook/explore-data/blob/master/_bookdown_files/eda-book_files/figure-html/scatterplots-4.png" height="54px">
</td>
<td style="text-align:left;">
Very little variation around the trend
</td>
</tr>
<tr>
<td style="text-align:left;">
moderate
</td>
<td style="text-align:left;">
<img src="https://github.com/dicook/explore-data/blob/master/_bookdown_files/eda-book_files/figure-html/scatterplots-5.png" height="54px">
</td>
<td style="text-align:left;">
Variation around the trend is almost as much as the trend
</td>
</tr>
<tr>
<td style="text-align:left;">
weak
</td>
<td style="text-align:left;">
<img src="https://github.com/dicook/explore-data/blob/master/_bookdown_files/eda-book_files/figure-html/scatterplots-6.png" height="54px">
</td>
<td style="text-align:left;">
A lot of variation making it hard to see any trend
</td>
</tr>
<tr>
<td style="text-align:left;">
linear form
</td>
<td style="text-align:left;">
<img src="https://github.com/dicook/explore-data/blob/master/_bookdown_files/eda-book_files/figure-html/scatterplots2-1.png" height="54px">
</td>
<td style="text-align:left;">
The shape is linear
</td>
</tr>
<tr>
<td style="text-align:left;">
nonlinear form
</td>
<td style="text-align:left;">
<img src="https://github.com/dicook/explore-data/blob/master/_bookdown_files/eda-book_files/figure-html/scatterplots2-2.png" height="54px">
</td>
<td style="text-align:left;">
The shape is more of a curve
</td>
</tr>
<tr>
<td style="text-align:left;">
nonlinear form
</td>
<td style="text-align:left;">
<img src="https://github.com/dicook/explore-data/blob/master/_bookdown_files/eda-book_files/figure-html/scatterplots2-3.png" height="54px">
</td>
<td style="text-align:left;">
The shape is more of a curve
</td>
</tr>
<tr>
<td style="text-align:left;">
outliers
</td>
<td style="text-align:left;">
<img src="https://github.com/dicook/explore-data/blob/master/_bookdown_files/eda-book_files/figure-html/scatterplots2-4.png" height="54px">
</td>
<td style="text-align:left;">
There are one or more points that do not fit the pattern on the others
</td>
</tr>
<tr>
<td style="text-align:left;">
clusters
</td>
<td style="text-align:left;">
<img src="https://github.com/dicook/explore-data/blob/master/_bookdown_files/eda-book_files/figure-html/scatterplots2-5.png" height="54px">
</td>
<td style="text-align:left;">
The observations group into multiple clumps
</td>
</tr>
<tr>
<td style="text-align:left;">
gaps
</td>
<td style="text-align:left;">
<img src="https://github.com/dicook/explore-data/blob/master/_bookdown_files/eda-book_files/figure-html/scatterplots2-6.png" height="54px">
</td>
<td style="text-align:left;">
There is a gap, or gaps, but its not clumped
</td>
</tr>
<tr>
<td style="text-align:left;">
barrier
</td>
<td style="text-align:left;">
<img src="https://github.com/dicook/explore-data/blob/master/_bookdown_files/eda-book_files/figure-html/scatterplots3-1.png" height="54px">
</td>
<td style="text-align:left;">
There is combination of the variables which appears impossible
</td>
</tr>
<tr>
<td style="text-align:left;">
l-shape
</td>
<td style="text-align:left;">
<img src="https://github.com/dicook/explore-data/blob/master/_bookdown_files/eda-book_files/figure-html/scatterplots3-2.png" height="54px">
</td>
<td style="text-align:left;">
When one variable changes the other is approximately constant
</td>
</tr>
<tr>
<td style="text-align:left;">
discreteness
</td>
<td style="text-align:left;">
<img src="https://github.com/dicook/explore-data/blob/master/_bookdown_files/eda-book_files/figure-html/scatterplots3-3.png" height="54px">
</td>
<td style="text-align:left;">
Relationship between two variables is different from the overall, and observations are in a striped pattern
</td>
</tr>
<tr>
<td style="text-align:left;">
heteroskedastic
</td>
<td style="text-align:left;">
<img src="https://github.com/dicook/explore-data/blob/master/_bookdown_files/eda-book_files/figure-html/scatterplots3-4.png" height="54px">
</td>
<td style="text-align:left;">
Variation is different in different areas, maybe depends on value of x variable
</td>
</tr>
<tr>
<td style="text-align:left;">
weighted
</td>
<td style="text-align:left;">
<img src="https://github.com/dicook/explore-data/blob/master/_bookdown_files/eda-book_files/figure-html/scatterplots3-5.png" height="54px">
</td>
<td style="text-align:left;">
If observations have an associated weight, reflect in scatterplot, e.g. bubble chart
</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>Weighted</strong> doesn’t fit structure table, but its there to remind us not to forget about weighted data</li>
<li><strong>causation</strong>: one variable has a direct influence on the other variable, in some way. For example, people who are taller tend to weigh more. The dependent variable is conventionally on the y axis. <em>It’s not generally possible to tell from the plot that the relationship is causal, which typically needs to be argued from other sources of information.</em></li>
<li><strong>association</strong>: variables may be related to one another, but through a different variable, eg ice cream sales are positively correlated with beach drownings, is most likely a temperature relationship.</li>
<li><strong>conditional relationships</strong>: the relationship between variables is conditionally dependent on another, such as income against age likely has a different relationship depending on retired or not.</li>
</ul>
<div id="anscombes-quartet" class="section level3 hasAnchor" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> Anscombe’s quartet<a href="bivariate-dependencies-and-relationships.html#anscombes-quartet" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><img src="eda-book_files/figure-html/anscombe-1.png" width="100%" /></p>
<p>All four sets of Anscombe has .monash-orange2[same means, standard deviations and correlations], <span class="math inline">\(\bar{x}\)</span> = 9, <span class="math inline">\(\bar{y}\)</span> = 7.5, <span class="math inline">\(s_x\)</span> = 3.3,
<span class="math inline">\(s_y\)</span> = 2, <span class="math inline">\(r\)</span> = 0.82.</p>
</div>
<div id="datasaurus-dozen" class="section level3 hasAnchor" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> DatasauRus dozen<a href="bivariate-dependencies-and-relationships.html#datasaurus-dozen" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><img src="eda-book_files/figure-html/dinosaur-1.png" width="30%" /></p>
<p><img src="eda-book_files/figure-html/datasaurus-1.png" width="60%" /></p>
<p>All 13 sets of the datasaurus dozen have .monash-orange2[same means, standard deviations and correlations], <span class="math inline">\(\bar{x}\)</span> = 54, <span class="math inline">\(\bar{y}\)</span> = 48, <span class="math inline">\(s_x\)</span> = 17,
<span class="math inline">\(s_y\)</span> = 27, <span class="math inline">\(r\)</span> = -0.06.</p>
</div>
</div>
<div id="case-study-1-olympics" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Case study 1: olympics<a href="bivariate-dependencies-and-relationships.html#case-study-1-olympics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<pre><code>## Rows: 10,384
## Columns: 14
## $ Name    &lt;fct&gt; Lamusi A, A G Kruger, Jamale Aarrass, Abdelhak Aatakni, Maria …
## $ Country &lt;fct&gt; &quot;People&#39;s Republic of China&quot;, &quot;United States of America&quot;, &quot;Fra…
## $ Age     &lt;int&gt; 23, 33, 30, 24, 26, 27, 30, 23, 27, 19, 37, 28, 28, 28, 22, 19…
## $ Height  &lt;dbl&gt; 1.70, 1.93, 1.87, NA, 1.78, 1.82, 1.82, 1.87, 1.90, 1.70, NA, …
## $ Weight  &lt;int&gt; 60, 125, 76, NA, 85, 80, 73, 75, 80, NA, NA, NA, 60, 64, 62, N…
## $ Sex     &lt;fct&gt; M, M, M, M, F, M, F, M, M, M, M, M, F, F, M, F, M, M, M, M, F,…
## $ DOB     &lt;date&gt; 1989-02-06, NA, NA, 1988-09-02, NA, 1984-06-09, NA, 1989-03-0…
## $ PlaceOB &lt;fct&gt; &quot;NEIMONGGOL (CHN)&quot;, &quot;Sheldon (USA)&quot;, &quot;BEZONS (FRA)&quot;, &quot;AIN SEBA…
## $ Gold    &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
## $ Silver  &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
## $ Bronze  &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
## $ Total   &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
## $ Sport   &lt;fct&gt; &quot;Judo&quot;, &quot;Athletics&quot;, &quot;Athletics&quot;, &quot;Boxing&quot;, &quot;Athletics&quot;, &quot;Hand…
## $ Event   &lt;fct&gt; &quot;Men&#39;s -60kg&quot;, &quot;Men&#39;s Hammer Throw&quot;, &quot;Men&#39;s 1500m&quot;, &quot;Men&#39;s Lig…</code></pre>
<p><img src="eda-book_files/figure-html/2012-olympics-plot1-1.png" width="614.4" /></p>
<ul>
<li><code>Warning message: Removed 1346 rows containing missing values (geom_point)</code></li>
<li>The expected linear relationship between height and weight is visible, although obscured by outliers.</li>
<li>Some discretization of heights, and higher weight values.</li>
<li>Likely to be substantial overplotting (57 athletes 1.7m, 60kg can’t tell this from this plot).</li>
<li>Note the unusual height-weight combinations. What sport(s) would you expect some of these athletes might be participating in?</li>
</ul>
<div class="do">
<p>Your turn, cut and paste the code into your R console, and <span class="fa-2x faa-ring animated-hover faa-slow " style=" color:#D93F00; display: -moz-inline-stack; display: inline-block; transform: rotate(0deg);">mouse over</span> the resulting plot to examine the sport of the athlete.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="bivariate-dependencies-and-relationships.html#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) </span>
<span id="cb2-2"><a href="bivariate-dependencies-and-relationships.html#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly) </span>
<span id="cb2-3"><a href="bivariate-dependencies-and-relationships.html#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(oly12, <span class="at">package =</span> <span class="st">&quot;VGAMdata&quot;</span>) </span>
<span id="cb2-4"><a href="bivariate-dependencies-and-relationships.html#cb2-4" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(oly12, <span class="fu">aes</span>(<span class="at">x=</span>Height, <span class="at">y=</span>Weight, <span class="at">label=</span>Sport)) <span class="sc">+</span> </span>
<span id="cb2-5"><a href="bivariate-dependencies-and-relationships.html#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb2-6"><a href="bivariate-dependencies-and-relationships.html#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(p) </span></code></pre></div>
</div>
<div id="how-many-athletes-in-the-different-sports" class="section level3 hasAnchor" number="5.3.1">
<h3><span class="header-section-number">5.3.1</span> How many athletes in the different sports?<a href="bivariate-dependencies-and-relationships.html#how-many-athletes-in-the-different-sports" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="quhcwgcybs" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#quhcwgcybs .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#quhcwgcybs .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#quhcwgcybs .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#quhcwgcybs .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#quhcwgcybs .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#quhcwgcybs .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#quhcwgcybs .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#quhcwgcybs .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#quhcwgcybs .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#quhcwgcybs .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#quhcwgcybs .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#quhcwgcybs .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#quhcwgcybs .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#quhcwgcybs .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#quhcwgcybs .gt_from_md > :first-child {
  margin-top: 0;
}

#quhcwgcybs .gt_from_md > :last-child {
  margin-bottom: 0;
}

#quhcwgcybs .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#quhcwgcybs .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#quhcwgcybs .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#quhcwgcybs .gt_row_group_first td {
  border-top-width: 2px;
}

#quhcwgcybs .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#quhcwgcybs .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#quhcwgcybs .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#quhcwgcybs .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#quhcwgcybs .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#quhcwgcybs .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#quhcwgcybs .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#quhcwgcybs .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#quhcwgcybs .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#quhcwgcybs .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#quhcwgcybs .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#quhcwgcybs .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#quhcwgcybs .gt_left {
  text-align: left;
}

#quhcwgcybs .gt_center {
  text-align: center;
}

#quhcwgcybs .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#quhcwgcybs .gt_font_normal {
  font-weight: normal;
}

#quhcwgcybs .gt_font_bold {
  font-weight: bold;
}

#quhcwgcybs .gt_font_italic {
  font-style: italic;
}

#quhcwgcybs .gt_super {
  font-size: 65%;
}

#quhcwgcybs .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#quhcwgcybs .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#quhcwgcybs .gt_indent_1 {
  text-indent: 5px;
}

#quhcwgcybs .gt_indent_2 {
  text-indent: 10px;
}

#quhcwgcybs .gt_indent_3 {
  text-indent: 15px;
}

#quhcwgcybs .gt_indent_4 {
  text-indent: 20px;
}

#quhcwgcybs .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Sport">Sport</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="n">n</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="Sport" class="gt_row gt_center">Athletics</td>
<td headers="n" class="gt_row gt_right">2120</td></tr>
    <tr><td headers="Sport" class="gt_row gt_center">Swimming</td>
<td headers="n" class="gt_row gt_right">907</td></tr>
    <tr><td headers="Sport" class="gt_row gt_center">Football</td>
<td headers="n" class="gt_row gt_right">596</td></tr>
    <tr><td headers="Sport" class="gt_row gt_center">Rowing</td>
<td headers="n" class="gt_row gt_right">524</td></tr>
    <tr><td headers="Sport" class="gt_row gt_center">Cycling</td>
<td headers="n" class="gt_row gt_right">489</td></tr>
    <tr><td headers="Sport" class="gt_row gt_center">Hockey</td>
<td headers="n" class="gt_row gt_right">416</td></tr>
    <tr><td headers="Sport" class="gt_row gt_center">Judo</td>
<td headers="n" class="gt_row gt_right">368</td></tr>
    <tr><td headers="Sport" class="gt_row gt_center">Shooting</td>
<td headers="n" class="gt_row gt_right">368</td></tr>
    <tr><td headers="Sport" class="gt_row gt_center">Sailing</td>
<td headers="n" class="gt_row gt_right">360</td></tr>
    <tr><td headers="Sport" class="gt_row gt_center">Wrestling</td>
<td headers="n" class="gt_row gt_right">324</td></tr>
    <tr><td headers="Sport" class="gt_row gt_center">Handball</td>
<td headers="n" class="gt_row gt_right">319</td></tr>
    <tr><td headers="Sport" class="gt_row gt_center">Gymnastics</td>
<td headers="n" class="gt_row gt_right">274</td></tr>
    <tr><td headers="Sport" class="gt_row gt_center">Boxing</td>
<td headers="n" class="gt_row gt_right">272</td></tr>
    <tr><td headers="Sport" class="gt_row gt_center">Volleyball</td>
<td headers="n" class="gt_row gt_right">271</td></tr>
    <tr><td headers="Sport" class="gt_row gt_center">Basketball</td>
<td headers="n" class="gt_row gt_right">269</td></tr>
    <tr><td headers="Sport" class="gt_row gt_center">Water Polo</td>
<td headers="n" class="gt_row gt_right">249</td></tr>
    <tr><td headers="Sport" class="gt_row gt_center">Weightlifting</td>
<td headers="n" class="gt_row gt_right">243</td></tr>
    <tr><td headers="Sport" class="gt_row gt_center">Fencing</td>
<td headers="n" class="gt_row gt_right">235</td></tr>
    <tr><td headers="Sport" class="gt_row gt_center">Canoe Sprint</td>
<td headers="n" class="gt_row gt_right">232</td></tr>
    <tr><td headers="Sport" class="gt_row gt_center">Equestrian</td>
<td headers="n" class="gt_row gt_right">191</td></tr>
    <tr><td headers="Sport" class="gt_row gt_center">Table Tennis</td>
<td headers="n" class="gt_row gt_right">167</td></tr>
    <tr><td headers="Sport" class="gt_row gt_center">Tennis</td>
<td headers="n" class="gt_row gt_right">167</td></tr>
    <tr><td headers="Sport" class="gt_row gt_center">Badminton</td>
<td headers="n" class="gt_row gt_right">166</td></tr>
    <tr><td headers="Sport" class="gt_row gt_center">Diving</td>
<td headers="n" class="gt_row gt_right">133</td></tr>
    <tr><td headers="Sport" class="gt_row gt_center">Taekwondo</td>
<td headers="n" class="gt_row gt_right">126</td></tr>
    <tr><td headers="Sport" class="gt_row gt_center">Archery</td>
<td headers="n" class="gt_row gt_right">121</td></tr>
    <tr><td headers="Sport" class="gt_row gt_center">Triathlon</td>
<td headers="n" class="gt_row gt_right">103</td></tr>
    <tr><td headers="Sport" class="gt_row gt_center">Synchronised Swimming</td>
<td headers="n" class="gt_row gt_right">101</td></tr>
    <tr><td headers="Sport" class="gt_row gt_center">Beach Volleyball</td>
<td headers="n" class="gt_row gt_right">93</td></tr>
    <tr><td headers="Sport" class="gt_row gt_center">Canoe Slalom</td>
<td headers="n" class="gt_row gt_right">80</td></tr>
    <tr><td headers="Sport" class="gt_row gt_center">Modern Pentathlon</td>
<td headers="n" class="gt_row gt_right">69</td></tr>
    <tr><td headers="Sport" class="gt_row gt_center">Trampoline</td>
<td headers="n" class="gt_row gt_right">31</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
<div id="consolidate-factor-levels" class="section level3 hasAnchor" number="5.3.2">
<h3><span class="header-section-number">5.3.2</span> Consolidate factor levels<a href="bivariate-dependencies-and-relationships.html#consolidate-factor-levels" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There are several cycling events that are reasonable to combine into one category. Similarly for gymnastics and athletics.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="bivariate-dependencies-and-relationships.html#cb3-1" aria-hidden="true" tabindex="-1"></a>oly12 <span class="ot">&lt;-</span> oly12 <span class="sc">%&gt;%</span> </span>
<span id="cb3-2"><a href="bivariate-dependencies-and-relationships.html#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Sport =</span> <span class="fu">as.character</span>(Sport)) <span class="sc">%&gt;%</span></span>
<span id="cb3-3"><a href="bivariate-dependencies-and-relationships.html#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Sport =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">&quot;Cycling&quot;</span>, Sport), <span class="co">#&lt;&lt;</span></span>
<span id="cb3-4"><a href="bivariate-dependencies-and-relationships.html#cb3-4" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;Cycling&quot;</span>, Sport)) <span class="sc">%&gt;%</span>  <span class="co">#&lt;&lt;</span></span>
<span id="cb3-5"><a href="bivariate-dependencies-and-relationships.html#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Sport =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">&quot;Gymnastics&quot;</span>, Sport),</span>
<span id="cb3-6"><a href="bivariate-dependencies-and-relationships.html#cb3-6" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;Gymnastics&quot;</span>, Sport)) <span class="sc">%&gt;%</span> </span>
<span id="cb3-7"><a href="bivariate-dependencies-and-relationships.html#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Sport =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">&quot;Athletics&quot;</span>, Sport),</span>
<span id="cb3-8"><a href="bivariate-dependencies-and-relationships.html#cb3-8" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&quot;Athletics&quot;</span>, Sport)) <span class="sc">%&gt;%</span> </span>
<span id="cb3-9"><a href="bivariate-dependencies-and-relationships.html#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Sport =</span> <span class="fu">as.factor</span>(Sport))</span></code></pre></div>
</div>
<div id="split-by-sport" class="section level3 hasAnchor" number="5.3.3">
<h3><span class="header-section-number">5.3.3</span> Split by sport<a href="bivariate-dependencies-and-relationships.html#split-by-sport" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><img src="eda-book_files/figure-html/oly_facet-1.png" width="70%" /></p>
<p>Note: alpha transparency, and aspect ratio</p>
<ul>
<li>Some sports have no data for height, weight</li>
<li>The positive association between height and weight is visible across sports</li>
<li>Nonlinear in wrestling?</li>
<li>An outlier in judo, and football, and archery</li>
<li>Maybe flatter among swimmers</li>
<li>Taller in basketball, volleyball and handball</li>
<li>Shorter in athletics, weightlifting and wrestling</li>
<li>Little variance in tennis players</li>
<li><em>It’s still messy, and hard to digest</em></li>
</ul>
<p>Things to do to make comparisons easier:</p>
<ul>
<li>Remove sports with missings</li>
<li>Make regression lines for remaining sports on one plot</li>
<li>Separately examine male/female athletes</li>
<li>Compare just one group against the rest</li>
</ul>
</div>
<div id="remove-missings-add-colour-for-sex" class="section level3 hasAnchor" number="5.3.4">
<h3><span class="header-section-number">5.3.4</span> Remove missings, add colour for sex<a href="bivariate-dependencies-and-relationships.html#remove-missings-add-colour-for-sex" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><img src="eda-book_files/figure-html/oly_women-1.png" width="70%" /></p>
<p>Note: Because the focus is now on males vs females association shape within sport, make plots scale separately.</p>
<ul>
<li>Athletics category should have been broken into several more categories like track, field: a shot-putter has a very different physique to a sprinter.</li>
<li>Generally, clustering of male/female athletes</li>
<li>Outliers: a tall skinny male archer, a medium height very light female athletics athlete, tall light female weightlifter, tall light male volleyballer</li>
<li>Canoe slalom athletes, divers, cyclists are tiny.</li>
</ul>
</div>
<div id="comparing-association" class="section level3 hasAnchor" number="5.3.5">
<h3><span class="header-section-number">5.3.5</span> Comparing association<a href="bivariate-dependencies-and-relationships.html#comparing-association" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="eda-book_files/figure-html/oly_model-1.png" width="100%" /></p>
<ul>
<li>Weightlifters are much heavier relative to height</li>
<li>Swimmers are leaner relative to height</li>
<li>Tennis players are a bit mixed, shorter tend to be heavier, taller tend to be lighter</li>
</ul>
</div>
<div id="comparing-variability" class="section level3 hasAnchor" number="5.3.6">
<h3><span class="header-section-number">5.3.6</span> Comparing variability<a href="bivariate-dependencies-and-relationships.html#comparing-variability" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><img src="eda-book_files/figure-html/oly_density-1.png" width="100%" /></p>
<ul>
<li>Modern pentathlon athletes are uniformly height and weight related</li>
<li>Shooters are quite varied in body type</li>
</ul>
</div>
<div id="summary-1" class="section level3 hasAnchor" number="5.3.7">
<h3><span class="header-section-number">5.3.7</span> Summary<a href="bivariate-dependencies-and-relationships.html#summary-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We have seen that the association between height and weight is “contaminated” by different variables, sport, gender, and possibly country and age, too.</p>
<p>Some of the categories also are “contaminated”, for example, “Athletics” is masking many different types of events. This <strong>lurking</strong> variable probably contributes to different relationships depending on the event. There is another variable in the data set called <code>Event</code>. Athletics could be further divided based on key words in this variable.</p>
<div class="question">
<p>If you were just given the Height and Weight in this data could you have detected the presence of conditional relationships? Can you see the conditional dependencies?</p>
</div>
<p><img src="eda-book_files/figure-html/oly_canyousee-1.png" width="70%" /></p>
<p>There is a hint of multimodality, barely a hint. It’s not easy to detect the presence of the additional variable, and thus accurately describe the relationship between height and weight among Olympic athletes.</p>
</div>
<div id="scatterplot-modifications-and-purpose" class="section level3 hasAnchor" number="5.3.8">
<h3><span class="header-section-number">5.3.8</span> Scatterplot modifications and purpose<a href="bivariate-dependencies-and-relationships.html#scatterplot-modifications-and-purpose" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Modification
</th>
<th style="text-align:left;">
Example
</th>
<th style="text-align:left;">
Purpose
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
none
</td>
<td style="text-align:left;">
<img src="https://github.com/dicook/explore-data/blob/master/_bookdown_files/eda-book_files/figure-html/scatmodify-1.png" height="54px">
</td>
<td style="text-align:left;">
raw information
</td>
</tr>
<tr>
<td style="text-align:left;">
alpha-blend
</td>
<td style="text-align:left;">
<img src="https://github.com/dicook/explore-data/blob/master/_bookdown_files/eda-book_files/figure-html/scatmodify-2.png" height="54px">
</td>
<td style="text-align:left;">
alleviate overplotting to examine density at centre
</td>
</tr>
<tr>
<td style="text-align:left;">
model overlay
</td>
<td style="text-align:left;">
<img src="https://github.com/dicook/explore-data/blob/master/_bookdown_files/eda-book_files/figure-html/scatmodify-3.png" height="54px">
</td>
<td style="text-align:left;">
focus on the trend
</td>
</tr>
<tr>
<td style="text-align:left;">
model + data
</td>
<td style="text-align:left;">
<img src="https://github.com/dicook/explore-data/blob/master/_bookdown_files/eda-book_files/figure-html/scatmodify-4.png" height="54px">
</td>
<td style="text-align:left;">
trend plus variation
</td>
</tr>
<tr>
<td style="text-align:left;">
density
</td>
<td style="text-align:left;">
<img src="https://github.com/dicook/explore-data/blob/master/_bookdown_files/eda-book_files/figure-html/scatmodify-5.png" height="54px">
</td>
<td style="text-align:left;">
overall distribution, variation and clustering
</td>
</tr>
<tr>
<td style="text-align:left;">
filled density
</td>
<td style="text-align:left;">
<img src="https://github.com/dicook/explore-data/blob/master/_bookdown_files/eda-book_files/figure-html/scatmodify-6.png" height="54px">
</td>
<td style="text-align:left;">
high density locations in distribution (modes), variation and clustering
</td>
</tr>
<tr>
<td style="text-align:left;">
colour
</td>
<td style="text-align:left;">
<img src="https://github.com/dicook/explore-data/blob/master/_bookdown_files/eda-book_files/figure-html/scatmodify-7.png" height="54px">
</td>
<td style="text-align:left;">
relationship with conditioning and lurking variables
</td>
</tr>
<tr>
<td style="text-align:left;">
colour + density
</td>
<td style="text-align:left;">
<img src="https://github.com/dicook/explore-data/blob/master/_bookdown_files/eda-book_files/figure-html/scatmodify-8.png" height="54px">
</td>
<td style="text-align:left;">
relationship with conditioning and lurking variables
</td>
</tr>
</tbody>
</table>
<div class="do">
<p><strong>About the Olympics 2012 data</strong></p>
<ul>
<li>What can this data be used for?</li>
<li>What’s the population?</li>
<li>What could be informed by what is learned from this sample?</li>
</ul>
</div>
</div>
</div>
<div id="numerical-measures-of-association" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Numerical measures of association<a href="bivariate-dependencies-and-relationships.html#numerical-measures-of-association" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="correlation" class="section level3 hasAnchor" number="5.4.1">
<h3><span class="header-section-number">5.4.1</span> Correlation<a href="bivariate-dependencies-and-relationships.html#correlation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Correlation between variables <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span>, with <span class="math inline">\(n\)</span> observations in each.</p>
<p><span class="math display">\[r = \frac{\sum_{i=1}^n (x_{i1}-\bar{x}_1)(x_{i2}-\bar{x}_2)}{\sqrt{\sum_{i=1}^n(x_{i1}-\bar{x}_1)^2\sum_{i=1}^n(x_{i2}-\bar{x}_2)^2}} = \frac{\mbox{covariance}(x_1, x_2)}{(n-1)s_{x_1}s_{x_2}}\]</span>
- Test for statistical significance, whether population correlation could be 0 based on observed <span class="math inline">\(r\)</span>, using a <span class="math inline">\(t_{n-2}\)</span> distribution:</p>
<p><span class="math display">\[t=\frac{r}{\sqrt{1-r^2}}\sqrt{n-2}\]</span>
TO DO: Tabulate the examples below</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="bivariate-dependencies-and-relationships.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">45</span>)</span>
<span id="cb5-2"><a href="bivariate-dependencies-and-relationships.html#cb5-2" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x=</span><span class="fu">runif</span>(<span class="dv">200</span>)<span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="bivariate-dependencies-and-relationships.html#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> <span class="dv">2</span><span class="sc">*</span>x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">200</span>))</span>
<span id="cb5-4"><a href="bivariate-dependencies-and-relationships.html#cb5-4" aria-hidden="true" tabindex="-1"></a>d1_p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d1, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y)) <span class="sc">+</span> </span>
<span id="cb5-5"><a href="bivariate-dependencies-and-relationships.html#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb5-6"><a href="bivariate-dependencies-and-relationships.html#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio=</span><span class="dv">1</span>)</span>
<span id="cb5-7"><a href="bivariate-dependencies-and-relationships.html#cb5-7" aria-hidden="true" tabindex="-1"></a>d1_p</span></code></pre></div>
<p><img src="eda-book_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="bivariate-dependencies-and-relationships.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(d1<span class="sc">$</span>x, d1<span class="sc">$</span>y) </span></code></pre></div>
<pre><code>## [1] 0.5228401</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="bivariate-dependencies-and-relationships.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(d1<span class="sc">$</span>x, d1<span class="sc">$</span>y) </span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  d1$x and d1$y
## t = 8.6306, df = 198, p-value = 1.993e-15
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.4141406 0.6168362
## sample estimates:
##       cor 
## 0.5228401</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="bivariate-dependencies-and-relationships.html#cb10-1" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x=</span><span class="fu">runif</span>(<span class="dv">200</span>)<span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="bivariate-dependencies-and-relationships.html#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">200</span>)<span class="sc">*</span><span class="fl">0.01</span>)</span>
<span id="cb10-3"><a href="bivariate-dependencies-and-relationships.html#cb10-3" aria-hidden="true" tabindex="-1"></a>d2_p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d2, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y)) <span class="sc">+</span> </span>
<span id="cb10-4"><a href="bivariate-dependencies-and-relationships.html#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb10-5"><a href="bivariate-dependencies-and-relationships.html#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio=</span><span class="dv">1</span>)</span>
<span id="cb10-6"><a href="bivariate-dependencies-and-relationships.html#cb10-6" aria-hidden="true" tabindex="-1"></a>d2_p</span></code></pre></div>
<p><img src="eda-book_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="bivariate-dependencies-and-relationships.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(d2<span class="sc">$</span>x, d2<span class="sc">$</span>y) </span></code></pre></div>
<pre><code>## [1] -0.04993755</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="bivariate-dependencies-and-relationships.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(d2<span class="sc">$</span>x, d2<span class="sc">$</span>y) </span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  d2$x and d2$y
## t = -0.70356, df = 198, p-value = 0.4825
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.18738032  0.08942303
## sample estimates:
##         cor 
## -0.04993755</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="bivariate-dependencies-and-relationships.html#cb15-1" aria-hidden="true" tabindex="-1"></a>d3 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">200</span>), <span class="dv">10</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="bivariate-dependencies-and-relationships.html#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">200</span>), <span class="dv">10</span>))</span>
<span id="cb15-3"><a href="bivariate-dependencies-and-relationships.html#cb15-3" aria-hidden="true" tabindex="-1"></a>d3_p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d3, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y)) <span class="sc">+</span> </span>
<span id="cb15-4"><a href="bivariate-dependencies-and-relationships.html#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb15-5"><a href="bivariate-dependencies-and-relationships.html#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio=</span><span class="dv">1</span>)</span>
<span id="cb15-6"><a href="bivariate-dependencies-and-relationships.html#cb15-6" aria-hidden="true" tabindex="-1"></a>d3_p </span></code></pre></div>
<p><img src="eda-book_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>All observations</p>
<pre><code>## $estimate
##       cor 
## 0.2994041 
## 
## $statistic
##        t 
## 4.426682 
## 
## $p.value
## [1] 1.576086e-05</code></pre>
<p>Without outlier</p>
<pre><code>## $estimate
##         cor 
## -0.01173776 
## 
## $statistic
##          t 
## -0.1651764 
## 
## $p.value
## [1] 0.8689737</code></pre>
</div>
<div id="peceiving-correlation" class="section level3 hasAnchor" number="5.4.2">
<h3><span class="header-section-number">5.4.2</span> Peceiving correlation<a href="bivariate-dependencies-and-relationships.html#peceiving-correlation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="bivariate-dependencies-and-relationships.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7777</span>)</span>
<span id="cb18-2"><a href="bivariate-dependencies-and-relationships.html#cb18-2" aria-hidden="true" tabindex="-1"></a>vc <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">ncol=</span><span class="dv">2</span>, <span class="at">byrow=</span>T)</span>
<span id="cb18-3"><a href="bivariate-dependencies-and-relationships.html#cb18-3" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">rmvnorm</span>(<span class="dv">500</span>, <span class="at">sigma=</span>vc))</span></code></pre></div>
<pre><code>## Warning: The `x` argument of `as_tibble.matrix()` must have unique column names if
## `.name_repair` is omitted as of tibble 2.0.0.
## ℹ Using compatibility `.name_repair`.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="bivariate-dependencies-and-relationships.html#cb20-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d, <span class="fu">aes</span>(<span class="at">x=</span>V1, <span class="at">y=</span>V2)) <span class="sc">+</span></span>
<span id="cb20-2"><a href="bivariate-dependencies-and-relationships.html#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb20-3"><a href="bivariate-dependencies-and-relationships.html#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb20-4"><a href="bivariate-dependencies-and-relationships.html#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio=</span><span class="dv">1</span>, </span>
<span id="cb20-5"><a href="bivariate-dependencies-and-relationships.html#cb20-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background=</span><span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;gray90&quot;</span>))</span>
<span id="cb20-6"><a href="bivariate-dependencies-and-relationships.html#cb20-6" aria-hidden="true" tabindex="-1"></a>vc <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.4</span>,<span class="fl">0.4</span>,<span class="dv">1</span>), <span class="at">ncol=</span><span class="dv">2</span>, <span class="at">byrow=</span>T)</span>
<span id="cb20-7"><a href="bivariate-dependencies-and-relationships.html#cb20-7" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">rmvnorm</span>(<span class="dv">500</span>, <span class="at">sigma=</span>vc))</span>
<span id="cb20-8"><a href="bivariate-dependencies-and-relationships.html#cb20-8" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d, <span class="fu">aes</span>(<span class="at">x=</span>V1, <span class="at">y=</span>V2)) <span class="sc">+</span></span>
<span id="cb20-9"><a href="bivariate-dependencies-and-relationships.html#cb20-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb20-10"><a href="bivariate-dependencies-and-relationships.html#cb20-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb20-11"><a href="bivariate-dependencies-and-relationships.html#cb20-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio=</span><span class="dv">1</span>, </span>
<span id="cb20-12"><a href="bivariate-dependencies-and-relationships.html#cb20-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background=</span><span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;gray90&quot;</span>))</span>
<span id="cb20-13"><a href="bivariate-dependencies-and-relationships.html#cb20-13" aria-hidden="true" tabindex="-1"></a>vc <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.6</span>,<span class="fl">0.6</span>,<span class="dv">1</span>), <span class="at">ncol=</span><span class="dv">2</span>, <span class="at">byrow=</span>T)</span>
<span id="cb20-14"><a href="bivariate-dependencies-and-relationships.html#cb20-14" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">rmvnorm</span>(<span class="dv">500</span>, <span class="at">sigma=</span>vc))</span>
<span id="cb20-15"><a href="bivariate-dependencies-and-relationships.html#cb20-15" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d, <span class="fu">aes</span>(<span class="at">x=</span>V1, <span class="at">y=</span>V2)) <span class="sc">+</span></span>
<span id="cb20-16"><a href="bivariate-dependencies-and-relationships.html#cb20-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb20-17"><a href="bivariate-dependencies-and-relationships.html#cb20-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb20-18"><a href="bivariate-dependencies-and-relationships.html#cb20-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio=</span><span class="dv">1</span>, </span>
<span id="cb20-19"><a href="bivariate-dependencies-and-relationships.html#cb20-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background=</span><span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;gray90&quot;</span>))</span>
<span id="cb20-20"><a href="bivariate-dependencies-and-relationships.html#cb20-20" aria-hidden="true" tabindex="-1"></a>vc <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.8</span>,<span class="fl">0.8</span>,<span class="dv">1</span>), <span class="at">ncol=</span><span class="dv">2</span>, <span class="at">byrow=</span>T)</span>
<span id="cb20-21"><a href="bivariate-dependencies-and-relationships.html#cb20-21" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">rmvnorm</span>(<span class="dv">500</span>, <span class="at">sigma=</span>vc))</span>
<span id="cb20-22"><a href="bivariate-dependencies-and-relationships.html#cb20-22" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d, <span class="fu">aes</span>(<span class="at">x=</span>V1, <span class="at">y=</span>V2)) <span class="sc">+</span></span>
<span id="cb20-23"><a href="bivariate-dependencies-and-relationships.html#cb20-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb20-24"><a href="bivariate-dependencies-and-relationships.html#cb20-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb20-25"><a href="bivariate-dependencies-and-relationships.html#cb20-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio=</span><span class="dv">1</span>, </span>
<span id="cb20-26"><a href="bivariate-dependencies-and-relationships.html#cb20-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background=</span><span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;gray90&quot;</span>))</span>
<span id="cb20-27"><a href="bivariate-dependencies-and-relationships.html#cb20-27" aria-hidden="true" tabindex="-1"></a>vc <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.2</span>,<span class="sc">-</span><span class="fl">0.2</span>,<span class="dv">1</span>), <span class="at">ncol=</span><span class="dv">2</span>, <span class="at">byrow=</span>T)</span>
<span id="cb20-28"><a href="bivariate-dependencies-and-relationships.html#cb20-28" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">rmvnorm</span>(<span class="dv">500</span>, <span class="at">sigma=</span>vc))</span>
<span id="cb20-29"><a href="bivariate-dependencies-and-relationships.html#cb20-29" aria-hidden="true" tabindex="-1"></a>p5 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d, <span class="fu">aes</span>(<span class="at">x=</span>V1, <span class="at">y=</span>V2)) <span class="sc">+</span></span>
<span id="cb20-30"><a href="bivariate-dependencies-and-relationships.html#cb20-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb20-31"><a href="bivariate-dependencies-and-relationships.html#cb20-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb20-32"><a href="bivariate-dependencies-and-relationships.html#cb20-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio=</span><span class="dv">1</span>, </span>
<span id="cb20-33"><a href="bivariate-dependencies-and-relationships.html#cb20-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background=</span><span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;gray90&quot;</span>))</span>
<span id="cb20-34"><a href="bivariate-dependencies-and-relationships.html#cb20-34" aria-hidden="true" tabindex="-1"></a>vc <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.5</span>,<span class="sc">-</span><span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">ncol=</span><span class="dv">2</span>, <span class="at">byrow=</span>T)</span>
<span id="cb20-35"><a href="bivariate-dependencies-and-relationships.html#cb20-35" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">rmvnorm</span>(<span class="dv">500</span>, <span class="at">sigma=</span>vc))</span>
<span id="cb20-36"><a href="bivariate-dependencies-and-relationships.html#cb20-36" aria-hidden="true" tabindex="-1"></a>p6 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d, <span class="fu">aes</span>(<span class="at">x=</span>V1, <span class="at">y=</span>V2)) <span class="sc">+</span></span>
<span id="cb20-37"><a href="bivariate-dependencies-and-relationships.html#cb20-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb20-38"><a href="bivariate-dependencies-and-relationships.html#cb20-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb20-39"><a href="bivariate-dependencies-and-relationships.html#cb20-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio=</span><span class="dv">1</span>, </span>
<span id="cb20-40"><a href="bivariate-dependencies-and-relationships.html#cb20-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background=</span><span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;gray90&quot;</span>))</span>
<span id="cb20-41"><a href="bivariate-dependencies-and-relationships.html#cb20-41" aria-hidden="true" tabindex="-1"></a>vc <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.7</span>,<span class="sc">-</span><span class="fl">0.7</span>,<span class="dv">1</span>), <span class="at">ncol=</span><span class="dv">2</span>, <span class="at">byrow=</span>T)</span>
<span id="cb20-42"><a href="bivariate-dependencies-and-relationships.html#cb20-42" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">rmvnorm</span>(<span class="dv">500</span>, <span class="at">sigma=</span>vc))</span>
<span id="cb20-43"><a href="bivariate-dependencies-and-relationships.html#cb20-43" aria-hidden="true" tabindex="-1"></a>p7 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d, <span class="fu">aes</span>(<span class="at">x=</span>V1, <span class="at">y=</span>V2)) <span class="sc">+</span></span>
<span id="cb20-44"><a href="bivariate-dependencies-and-relationships.html#cb20-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb20-45"><a href="bivariate-dependencies-and-relationships.html#cb20-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb20-46"><a href="bivariate-dependencies-and-relationships.html#cb20-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio=</span><span class="dv">1</span>, </span>
<span id="cb20-47"><a href="bivariate-dependencies-and-relationships.html#cb20-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background=</span><span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;gray90&quot;</span>))</span>
<span id="cb20-48"><a href="bivariate-dependencies-and-relationships.html#cb20-48" aria-hidden="true" tabindex="-1"></a>vc <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.9</span>,<span class="sc">-</span><span class="fl">0.9</span>,<span class="dv">1</span>), <span class="at">ncol=</span><span class="dv">2</span>, <span class="at">byrow=</span>T)</span>
<span id="cb20-49"><a href="bivariate-dependencies-and-relationships.html#cb20-49" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">rmvnorm</span>(<span class="dv">500</span>, <span class="at">sigma=</span>vc))</span>
<span id="cb20-50"><a href="bivariate-dependencies-and-relationships.html#cb20-50" aria-hidden="true" tabindex="-1"></a>p8 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d, <span class="fu">aes</span>(<span class="at">x=</span>V1, <span class="at">y=</span>V2)) <span class="sc">+</span></span>
<span id="cb20-51"><a href="bivariate-dependencies-and-relationships.html#cb20-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb20-52"><a href="bivariate-dependencies-and-relationships.html#cb20-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb20-53"><a href="bivariate-dependencies-and-relationships.html#cb20-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio=</span><span class="dv">1</span>, </span>
<span id="cb20-54"><a href="bivariate-dependencies-and-relationships.html#cb20-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background=</span><span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;gray90&quot;</span>))</span>
<span id="cb20-55"><a href="bivariate-dependencies-and-relationships.html#cb20-55" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3 <span class="sc">+</span> p4 <span class="sc">+</span> p5 <span class="sc">+</span> p6 <span class="sc">+</span> p7 <span class="sc">+</span> p8 <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">ncol=</span><span class="dv">4</span>)</span></code></pre></div>
<p><img src="eda-book_files/figure-html/simcor-1.png" width="70%" /></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="bivariate-dependencies-and-relationships.html#cb21-1" aria-hidden="true" tabindex="-1"></a>a1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb21-2"><a href="bivariate-dependencies-and-relationships.html#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="dv">0</span>, <span class="at">y=</span><span class="dv">0</span>, <span class="at">label=</span><span class="st">&quot;r = 0.0&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb21-3"><a href="bivariate-dependencies-and-relationships.html#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb21-4"><a href="bivariate-dependencies-and-relationships.html#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio=</span><span class="dv">1</span>, </span>
<span id="cb21-5"><a href="bivariate-dependencies-and-relationships.html#cb21-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background=</span><span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;gray90&quot;</span>))</span>
<span id="cb21-6"><a href="bivariate-dependencies-and-relationships.html#cb21-6" aria-hidden="true" tabindex="-1"></a>a2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb21-7"><a href="bivariate-dependencies-and-relationships.html#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="dv">0</span>, <span class="at">y=</span><span class="dv">0</span>, <span class="at">label=</span><span class="st">&quot;r = 0.4&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb21-8"><a href="bivariate-dependencies-and-relationships.html#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb21-9"><a href="bivariate-dependencies-and-relationships.html#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio=</span><span class="dv">1</span>, </span>
<span id="cb21-10"><a href="bivariate-dependencies-and-relationships.html#cb21-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background=</span><span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;gray90&quot;</span>))</span>
<span id="cb21-11"><a href="bivariate-dependencies-and-relationships.html#cb21-11" aria-hidden="true" tabindex="-1"></a>a3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb21-12"><a href="bivariate-dependencies-and-relationships.html#cb21-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="dv">0</span>, <span class="at">y=</span><span class="dv">0</span>, <span class="at">label=</span><span class="st">&quot;r = 0.6&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb21-13"><a href="bivariate-dependencies-and-relationships.html#cb21-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb21-14"><a href="bivariate-dependencies-and-relationships.html#cb21-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio=</span><span class="dv">1</span>, </span>
<span id="cb21-15"><a href="bivariate-dependencies-and-relationships.html#cb21-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background=</span><span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;gray90&quot;</span>))</span>
<span id="cb21-16"><a href="bivariate-dependencies-and-relationships.html#cb21-16" aria-hidden="true" tabindex="-1"></a>a4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb21-17"><a href="bivariate-dependencies-and-relationships.html#cb21-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="dv">0</span>, <span class="at">y=</span><span class="dv">0</span>, <span class="at">label=</span><span class="st">&quot;r = 0.8&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb21-18"><a href="bivariate-dependencies-and-relationships.html#cb21-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb21-19"><a href="bivariate-dependencies-and-relationships.html#cb21-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio=</span><span class="dv">1</span>, </span>
<span id="cb21-20"><a href="bivariate-dependencies-and-relationships.html#cb21-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background=</span><span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;gray90&quot;</span>))</span>
<span id="cb21-21"><a href="bivariate-dependencies-and-relationships.html#cb21-21" aria-hidden="true" tabindex="-1"></a>a5 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb21-22"><a href="bivariate-dependencies-and-relationships.html#cb21-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="dv">0</span>, <span class="at">y=</span><span class="dv">0</span>, <span class="at">label=</span><span class="st">&quot;r = -0.2&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb21-23"><a href="bivariate-dependencies-and-relationships.html#cb21-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb21-24"><a href="bivariate-dependencies-and-relationships.html#cb21-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio=</span><span class="dv">1</span>, </span>
<span id="cb21-25"><a href="bivariate-dependencies-and-relationships.html#cb21-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background=</span><span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;gray90&quot;</span>))</span>
<span id="cb21-26"><a href="bivariate-dependencies-and-relationships.html#cb21-26" aria-hidden="true" tabindex="-1"></a>a6 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb21-27"><a href="bivariate-dependencies-and-relationships.html#cb21-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="dv">0</span>, <span class="at">y=</span><span class="dv">0</span>, <span class="at">label=</span><span class="st">&quot;r = -0.5&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb21-28"><a href="bivariate-dependencies-and-relationships.html#cb21-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb21-29"><a href="bivariate-dependencies-and-relationships.html#cb21-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio=</span><span class="dv">1</span>, </span>
<span id="cb21-30"><a href="bivariate-dependencies-and-relationships.html#cb21-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background=</span><span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;gray90&quot;</span>))</span>
<span id="cb21-31"><a href="bivariate-dependencies-and-relationships.html#cb21-31" aria-hidden="true" tabindex="-1"></a>a7 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb21-32"><a href="bivariate-dependencies-and-relationships.html#cb21-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="dv">0</span>, <span class="at">y=</span><span class="dv">0</span>, <span class="at">label=</span><span class="st">&quot;r = -0.7&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb21-33"><a href="bivariate-dependencies-and-relationships.html#cb21-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb21-34"><a href="bivariate-dependencies-and-relationships.html#cb21-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio=</span><span class="dv">1</span>, </span>
<span id="cb21-35"><a href="bivariate-dependencies-and-relationships.html#cb21-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background=</span><span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;gray90&quot;</span>))</span>
<span id="cb21-36"><a href="bivariate-dependencies-and-relationships.html#cb21-36" aria-hidden="true" tabindex="-1"></a>a8 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb21-37"><a href="bivariate-dependencies-and-relationships.html#cb21-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="dv">0</span>, <span class="at">y=</span><span class="dv">0</span>, <span class="at">label=</span><span class="st">&quot;r = -0.9&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb21-38"><a href="bivariate-dependencies-and-relationships.html#cb21-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb21-39"><a href="bivariate-dependencies-and-relationships.html#cb21-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio=</span><span class="dv">1</span>, </span>
<span id="cb21-40"><a href="bivariate-dependencies-and-relationships.html#cb21-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background=</span><span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;gray90&quot;</span>))</span>
<span id="cb21-41"><a href="bivariate-dependencies-and-relationships.html#cb21-41" aria-hidden="true" tabindex="-1"></a>a1 <span class="sc">+</span> a2 <span class="sc">+</span> a3 <span class="sc">+</span> a4 <span class="sc">+</span> a5 <span class="sc">+</span> a6 <span class="sc">+</span> a7 <span class="sc">+</span> a8 <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">ncol=</span><span class="dv">4</span>)</span></code></pre></div>
<p><img src="eda-book_files/figure-html/unnamed-chunk-11-1.png" width="40%" /></p>
<p>Generally, people don’t do very well at this task. Typically people under-estimate <span class="math inline">\(r\)</span> from scatterplots, particularly when it is around 0.4-0.7. The variation in a scatterplot perceptually doesn’t vary is not linearly with <span class="math inline">\(r\)</span>.</p>
<div class="info">
<p>When someone says <em>correlation is 0.5</em> it sounds impressive. BUT when someone shows you a scatterplot of data that has correlation 0.5, you will say that’s a weak relationship.</p>
</div>
</div>
<div id="robust-correlation-measures" class="section level3 hasAnchor" number="5.4.3">
<h3><span class="header-section-number">5.4.3</span> Robust correlation measures<a href="bivariate-dependencies-and-relationships.html#robust-correlation-measures" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Spearman (based on ranks)
<ul>
<li>Sort each variable, and return rank (of actual value)</li>
<li>Compute correlation between ranks of each variable</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="bivariate-dependencies-and-relationships.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">60</span>)</span>
<span id="cb22-2"><a href="bivariate-dependencies-and-relationships.html#cb22-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">5</span>), <span class="dv">1</span>), <span class="dv">10</span>), </span>
<span id="cb22-3"><a href="bivariate-dependencies-and-relationships.html#cb22-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">y=</span><span class="fu">c</span>(<span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">5</span>), <span class="dv">1</span>), <span class="dv">10</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb22-4"><a href="bivariate-dependencies-and-relationships.html#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">xr =</span> <span class="fu">rank</span>(x), <span class="at">yr =</span> <span class="fu">rank</span>(y))</span>
<span id="cb22-5"><a href="bivariate-dependencies-and-relationships.html#cb22-5" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<pre><code>## # A tibble: 6 × 4
##       x     y    xr    yr
##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1   0.7  -1.7     5     1
## 2   0.5   1.1     4     5
## 3  -0.6   0.3     2     3
## 4  -0.2  -0.9     3     2
## 5  -1.7   0.4     1     4
## 6  10    10       6     6</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="bivariate-dependencies-and-relationships.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(df<span class="sc">$</span>x, df<span class="sc">$</span>y)</span></code></pre></div>
<pre><code>## [1] 0.935397</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="bivariate-dependencies-and-relationships.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(df<span class="sc">$</span>xr, df<span class="sc">$</span>yr)</span></code></pre></div>
<pre><code>## [1] 0.2</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="bivariate-dependencies-and-relationships.html#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(df<span class="sc">$</span>x, df<span class="sc">$</span>y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span></code></pre></div>
<pre><code>## [1] 0.2</code></pre>
</div>
<div id="robust-correlation-measures-1" class="section level3 hasAnchor" number="5.4.4">
<h3><span class="header-section-number">5.4.4</span> Robust correlation measures<a href="bivariate-dependencies-and-relationships.html#robust-correlation-measures-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Kendall <span class="math inline">\(\tau\)</span> (based on comparing pairs of observations)
<ul>
<li>Sort each variable, and return rank (of actual value)</li>
<li>For all pairs of observations <span class="math inline">\((x_i, y_i), (x_j, y_j)\)</span>, determine if <strong>concordant</strong>, <span class="math inline">\(x_i &lt; x_j, y_i &lt; y_j\)</span> or <span class="math inline">\(x_i &gt; x_j, y_i &gt; y_j\)</span>, or <strong>discordant</strong>, <span class="math inline">\(x_i &lt; x_j, y_i &gt; y_j\)</span> or <span class="math inline">\(x_i &gt; x_j, y_i &lt; y_j\)</span>.</li>
</ul></li>
</ul>
<p><span class="math display">\[\tau = \frac{n_c-n_d}{\frac12 n(n-1)}\]</span></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="bivariate-dependencies-and-relationships.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y)) <span class="sc">+</span> </span>
<span id="cb30-2"><a href="bivariate-dependencies-and-relationships.html#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="at">xmin =</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">xmax =</span> df<span class="sc">$</span>x[<span class="dv">2</span>], </span>
<span id="cb30-3"><a href="bivariate-dependencies-and-relationships.html#cb30-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">ymin =</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">ymax =</span> df<span class="sc">$</span>y[<span class="dv">2</span>],</span>
<span id="cb30-4"><a href="bivariate-dependencies-and-relationships.html#cb30-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill=</span><span class="st">&quot;red&quot;</span>, <span class="at">alpha=</span><span class="fl">0.5</span>, <span class="at">colour=</span><span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb30-5"><a href="bivariate-dependencies-and-relationships.html#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="at">xmin =</span> df<span class="sc">$</span>x[<span class="dv">2</span>], <span class="at">xmax =</span> <span class="dv">11</span>, </span>
<span id="cb30-6"><a href="bivariate-dependencies-and-relationships.html#cb30-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">ymin =</span> df<span class="sc">$</span>y[<span class="dv">2</span>], <span class="at">ymax =</span> <span class="dv">11</span>,</span>
<span id="cb30-7"><a href="bivariate-dependencies-and-relationships.html#cb30-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill=</span><span class="st">&quot;red&quot;</span>, <span class="at">alpha=</span><span class="fl">0.5</span>, <span class="at">colour=</span><span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb30-8"><a href="bivariate-dependencies-and-relationships.html#cb30-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="dv">3</span>, <span class="at">y =</span> <span class="dv">10</span>, <span class="at">label =</span> <span class="st">&quot;concordant&quot;</span>, <span class="at">colour=</span><span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb30-9"><a href="bivariate-dependencies-and-relationships.html#cb30-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="dv">5</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">1.5</span>, <span class="at">label =</span> <span class="st">&quot;disconcordant&quot;</span>) <span class="sc">+</span></span>
<span id="cb30-10"><a href="bivariate-dependencies-and-relationships.html#cb30-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb30-11"><a href="bivariate-dependencies-and-relationships.html#cb30-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;point&quot;</span>, <span class="at">x =</span> df<span class="sc">$</span>x[<span class="dv">2</span>], <span class="at">y =</span> df<span class="sc">$</span>y[<span class="dv">2</span>], <span class="at">color=</span><span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb30-12"><a href="bivariate-dependencies-and-relationships.html#cb30-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="eda-book_files/figure-html/unnamed-chunk-14-1.png" width="70%" /></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="bivariate-dependencies-and-relationships.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(df<span class="sc">$</span>x, df<span class="sc">$</span>y)</span></code></pre></div>
<pre><code>## [1] 0.935397</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="bivariate-dependencies-and-relationships.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(df<span class="sc">$</span>x, df<span class="sc">$</span>y, <span class="at">method =</span> <span class="st">&quot;kendall&quot;</span>)</span></code></pre></div>
<pre><code>## [1] 0.06666667</code></pre>
</div>
<div id="comparison-of-correlation-measures" class="section level3 hasAnchor" number="5.4.5">
<h3><span class="header-section-number">5.4.5</span> Comparison of correlation measures<a href="bivariate-dependencies-and-relationships.html#comparison-of-correlation-measures" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="bivariate-dependencies-and-relationships.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tribble</span>(<span class="sc">~</span>sample, <span class="sc">~</span>corr, <span class="sc">~</span>spearman, <span class="sc">~</span>kendall,</span>
<span id="cb35-2"><a href="bivariate-dependencies-and-relationships.html#cb35-2" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;&lt;img src=&quot;images/lecture-05B/diffscatter-1.png&quot; height =&quot;100px&quot;&gt;&#39;</span>, </span>
<span id="cb35-3"><a href="bivariate-dependencies-and-relationships.html#cb35-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cor</span>(d1<span class="sc">$</span>x, d1<span class="sc">$</span>y), </span>
<span id="cb35-4"><a href="bivariate-dependencies-and-relationships.html#cb35-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cor</span>(d1<span class="sc">$</span>x, d1<span class="sc">$</span>y, <span class="at">method=</span><span class="st">&quot;spearman&quot;</span>), </span>
<span id="cb35-5"><a href="bivariate-dependencies-and-relationships.html#cb35-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cor</span>(d1<span class="sc">$</span>x, d1<span class="sc">$</span>y, <span class="at">method=</span><span class="st">&quot;kendall&quot;</span>),</span>
<span id="cb35-6"><a href="bivariate-dependencies-and-relationships.html#cb35-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;&lt;img src=&quot;images/lecture-05B/diffscatter-2.png&quot; height =&quot;100px&quot;&gt;&#39;</span>, </span>
<span id="cb35-7"><a href="bivariate-dependencies-and-relationships.html#cb35-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cor</span>(d2<span class="sc">$</span>x, d2<span class="sc">$</span>y), </span>
<span id="cb35-8"><a href="bivariate-dependencies-and-relationships.html#cb35-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cor</span>(d2<span class="sc">$</span>x, d2<span class="sc">$</span>y, <span class="at">method=</span><span class="st">&quot;spearman&quot;</span>), </span>
<span id="cb35-9"><a href="bivariate-dependencies-and-relationships.html#cb35-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cor</span>(d2<span class="sc">$</span>x, d2<span class="sc">$</span>y, <span class="at">method=</span><span class="st">&quot;kendall&quot;</span>),</span>
<span id="cb35-10"><a href="bivariate-dependencies-and-relationships.html#cb35-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;&lt;img src=&quot;images/lecture-05B/diffscatter-3.png&quot; height =&quot;100px&quot;&gt;&#39;</span>, </span>
<span id="cb35-11"><a href="bivariate-dependencies-and-relationships.html#cb35-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cor</span>(d3<span class="sc">$</span>x, d3<span class="sc">$</span>y), </span>
<span id="cb35-12"><a href="bivariate-dependencies-and-relationships.html#cb35-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cor</span>(d3<span class="sc">$</span>x, d3<span class="sc">$</span>y, <span class="at">method=</span><span class="st">&quot;spearman&quot;</span>), </span>
<span id="cb35-13"><a href="bivariate-dependencies-and-relationships.html#cb35-13" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cor</span>(d3<span class="sc">$</span>x, d3<span class="sc">$</span>y, <span class="at">method=</span><span class="st">&quot;kendall&quot;</span>)</span>
<span id="cb35-14"><a href="bivariate-dependencies-and-relationships.html#cb35-14" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb35-15"><a href="bivariate-dependencies-and-relationships.html#cb35-15" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">escape =</span> <span class="cn">FALSE</span>, <span class="at">digits=</span><span class="dv">3</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb35-16"><a href="bivariate-dependencies-and-relationships.html#cb35-16" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-17"><a href="bivariate-dependencies-and-relationships.html#cb35-17" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_classic</span>()</span></code></pre></div>
<table class="table lightable-classic" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
sample
</th>
<th style="text-align:right;">
corr
</th>
<th style="text-align:right;">
spearman
</th>
<th style="text-align:right;">
kendall
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<img src="images/lecture-05B/diffscatter-1.png" height="100px">
</td>
<td style="text-align:right;">
0.523
</td>
<td style="text-align:right;">
0.512
</td>
<td style="text-align:right;">
0.355
</td>
</tr>
<tr>
<td style="text-align:left;">
<img src="images/lecture-05B/diffscatter-2.png" height="100px">
</td>
<td style="text-align:right;">
-0.050
</td>
<td style="text-align:right;">
-0.087
</td>
<td style="text-align:right;">
-0.073
</td>
</tr>
<tr>
<td style="text-align:left;">
<img src="images/lecture-05B/diffscatter-3.png" height="100px">
</td>
<td style="text-align:right;">
0.299
</td>
<td style="text-align:right;">
-0.023
</td>
<td style="text-align:right;">
-0.014
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="case-study-2-movies" class="section level2 hasAnchor" number="5.5">
<h2><span class="header-section-number">5.5</span> Case study 2: movies<a href="bivariate-dependencies-and-relationships.html#case-study-2-movies" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="bivariate-dependencies-and-relationships.html#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(movies, <span class="fu">aes</span>(<span class="at">x=</span>votes, <span class="at">y=</span>rating)) <span class="sc">+</span></span>
<span id="cb36-2"><a href="bivariate-dependencies-and-relationships.html#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb36-3"><a href="bivariate-dependencies-and-relationships.html#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;rating&quot;</span>, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">2</span>))</span></code></pre></div>
<p><img src="eda-book_files/figure-html/movies-1.png" width="80%" /></p>
<ul>
<li><code>votes</code>: Number of IMDB users who rated this movie</li>
<li><code>rating</code>: Average IMDB user rating</li>
</ul>
<p>Describe the relationship between rating and votes.</p>
<ul>
<li>Odd pattern, almost looks like an “r”</li>
<li>No films with lots of votes and low rating</li>
<li>No film with lots of votes has rating close to maximum possible: <strong>barrier?</strong></li>
<li>Films with very high ratings only have a few votes</li>
<li>Generally, rating appears to increase as votes increases (its hard to really read this with so few points though)</li>
<li>A few films with really large number of votes: <strong>outliers?</strong> or just <strong>skewness?</strong></li>
<li>Films with few votes have ratings that span the range of the scale.</li>
</ul>
<p><strong>Examine votes on a log scale</strong></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="bivariate-dependencies-and-relationships.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(movies, <span class="fu">aes</span>(<span class="at">x=</span>votes, <span class="at">y=</span>rating)) <span class="sc">+</span></span>
<span id="cb37-2"><a href="bivariate-dependencies-and-relationships.html#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha=</span><span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb37-3"><a href="bivariate-dependencies-and-relationships.html#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se=</span>F, <span class="at">colour=</span><span class="st">&quot;orange&quot;</span>, <span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb37-4"><a href="bivariate-dependencies-and-relationships.html#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span> </span>
<span id="cb37-5"><a href="bivariate-dependencies-and-relationships.html#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;rating&quot;</span>, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">2</span>))</span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;gam&#39; and formula = &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</code></pre>
<p><img src="eda-book_files/figure-html/logmovies-1.png" width="80%" /></p>
<ul>
<li>Some positive association between two variables only for large number of votes.</li>
<li><em>Note</em>: Used transparency (because there is a lot of data) and a loess smooth (because I am interested in assessing the trend between votes and rating).</li>
</ul>
<p>Correlation between raw variables is 0.1 and between transformed <code>log(votes)</code> and <code>rating</code> is 0.07. Which more accurately reflects the relationship?</p>
</div>
<div id="case-study-3-cars" class="section level2 hasAnchor" number="5.6">
<h2><span class="header-section-number">5.6</span> Case study 3: cars<a href="bivariate-dependencies-and-relationships.html#case-study-3-cars" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="bivariate-dependencies-and-relationships.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb39-2"><a href="bivariate-dependencies-and-relationships.html#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x=</span>hp, <span class="at">y=</span>mpg)) <span class="sc">+</span></span>
<span id="cb39-3"><a href="bivariate-dependencies-and-relationships.html#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb39-4"><a href="bivariate-dependencies-and-relationships.html#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">colour=</span><span class="st">&quot;forestgreen&quot;</span>, <span class="at">se=</span>F) </span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39;</code></pre>
<p><img src="eda-book_files/figure-html/cars-1.png" width="80%" /></p>
<ul>
<li><p><code>mpg</code>: Miles/(US) gallon</p></li>
<li><p><code>hp</code>: Gross horsepower</p></li>
<li><p>negative: as horsepower increases fuel efficiency is worse</p></li>
<li><p>nonlinear: for lower horse power the decrease in efficieny is more</p></li>
<li><p>strong: very little variation between cars, looks fundamentally like a physics problem</p></li>
<li><p>outlier: one car with high horse power has unusually high efficiency</p></li>
</ul>
<p><strong>Transform horsepower on log scale</strong></p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="bivariate-dependencies-and-relationships.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x=</span>hp, <span class="at">y=</span>mpg)) <span class="sc">+</span></span>
<span id="cb41-2"><a href="bivariate-dependencies-and-relationships.html#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb41-3"><a href="bivariate-dependencies-and-relationships.html#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="st">&quot;log mpg&quot;</span>) <span class="sc">+</span> <span class="co">#&lt;&lt;</span></span>
<span id="cb41-4"><a href="bivariate-dependencies-and-relationships.html#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>, <span class="at">colour=</span><span class="st">&quot;forestgreen&quot;</span>, <span class="at">se=</span>F) <span class="sc">+</span></span>
<span id="cb41-5"><a href="bivariate-dependencies-and-relationships.html#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">data=</span><span class="fu">filter</span>(mtcars, hp<span class="sc">&lt;</span><span class="dv">300</span>), <span class="at">method=</span><span class="st">&quot;lm&quot;</span>, <span class="at">colour=</span><span class="st">&quot;orangered&quot;</span>, <span class="at">se=</span>F, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;
## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="eda-book_files/figure-html/logcars-1.png" width="80%" /></p>
<p>Log transforming <code>mpg</code> linearised the relationship between horsepower and mpg.</p>
<p>Correlation between raw variables is -0.78 <br> and between transformed <code>log(mpg)</code> and <code>hp</code> is -0.85. Which more accurately reflects the relationship?</p>
<p>How does the correlation change if outlier is removed?</p>
</div>
<div id="circle-of-transformations-for-linearising" class="section level2 hasAnchor" number="5.7">
<h2><span class="header-section-number">5.7</span> Circle of transformations for linearising<a href="bivariate-dependencies-and-relationships.html#circle-of-transformations-for-linearising" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="bivariate-dependencies-and-relationships.html#cb43-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.95</span>, <span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">0.025</span>), <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.95</span>, <span class="fl">0.025</span>))</span>
<span id="cb43-2"><a href="bivariate-dependencies-and-relationships.html#cb43-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(x, x)</span>
<span id="cb43-3"><a href="bivariate-dependencies-and-relationships.html#cb43-3" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(x, <span class="at">y =</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span>), </span>
<span id="cb43-4"><a href="bivariate-dependencies-and-relationships.html#cb43-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">q=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;4&quot;</span>, <span class="dv">35</span>), </span>
<span id="cb43-5"><a href="bivariate-dependencies-and-relationships.html#cb43-5" aria-hidden="true" tabindex="-1"></a>                <span class="fu">rep</span>(<span class="st">&quot;1&quot;</span>, <span class="dv">35</span>),</span>
<span id="cb43-6"><a href="bivariate-dependencies-and-relationships.html#cb43-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">rep</span>(<span class="st">&quot;3&quot;</span>, <span class="dv">35</span>),</span>
<span id="cb43-7"><a href="bivariate-dependencies-and-relationships.html#cb43-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">rep</span>(<span class="st">&quot;2&quot;</span>, <span class="dv">35</span>)))</span>
<span id="cb43-8"><a href="bivariate-dependencies-and-relationships.html#cb43-8" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>y[<span class="dv">71</span><span class="sc">:</span><span class="dv">140</span>] <span class="ot">&lt;-</span> <span class="sc">-</span>d<span class="sc">$</span>y[<span class="dv">71</span><span class="sc">:</span><span class="dv">140</span>]</span>
<span id="cb43-9"><a href="bivariate-dependencies-and-relationships.html#cb43-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(d, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">colour=</span>q, <span class="at">group=</span>q)) <span class="sc">+</span></span>
<span id="cb43-10"><a href="bivariate-dependencies-and-relationships.html#cb43-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb43-11"><a href="bivariate-dependencies-and-relationships.html#cb43-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x=</span><span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="sc">-</span><span class="fl">0.5</span>),</span>
<span id="cb43-12"><a href="bivariate-dependencies-and-relationships.html#cb43-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">y=</span><span class="fu">c</span>(<span class="fl">0.5</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>), </span>
<span id="cb43-13"><a href="bivariate-dependencies-and-relationships.html#cb43-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">label=</span><span class="fu">c</span>(<span class="st">&quot;x up, y up&quot;</span>, <span class="st">&quot;x up, y down&quot;</span>, </span>
<span id="cb43-14"><a href="bivariate-dependencies-and-relationships.html#cb43-14" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;x down, y down&quot;</span>, <span class="st">&quot;x down, y up&quot;</span>),</span>
<span id="cb43-15"><a href="bivariate-dependencies-and-relationships.html#cb43-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">size=</span><span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb43-16"><a href="bivariate-dependencies-and-relationships.html#cb43-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="dv">0</span>) <span class="sc">+</span> <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb43-17"><a href="bivariate-dependencies-and-relationships.html#cb43-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x=</span><span class="dv">0</span>, <span class="at">y=</span><span class="dv">0</span>, <span class="at">label=</span><span class="st">&quot;(0,0)&quot;</span>, <span class="at">size=</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb43-18"><a href="bivariate-dependencies-and-relationships.html#cb43-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb43-19"><a href="bivariate-dependencies-and-relationships.html#cb43-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio=</span><span class="dv">1</span>, <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="eda-book_files/figure-html/circleoftrans-1.png" width="80%" /></p>
<p>Remember the power ladder:</p>
<p>-1, 0, 1/3, 1/2, .monash-orange2[1], 2, 3, 4</p>
<ol style="list-style-type: decimal">
<li>Look at the shape of the relationship.</li>
<li>Imagine this to be a number plane, and depending on which quadrant the shape falls in, you either transform <span class="math inline">\(x\)</span> or <span class="math inline">\(y\)</span>, up or down the ladder: <code>+,+</code> both up; <code>+,-</code> x up, y down; <code>-,-</code> both down; <code>-,+</code> x down, y up</li>
</ol>
<p>If there is heteroskedasticity, try transforming <span class="math inline">\(y\)</span>, may or may not help.</p>
</div>
<div id="case-study-4-soils" class="section level2 hasAnchor" number="5.8">
<h2><span class="header-section-number">5.8</span> Case study 4: soils<a href="bivariate-dependencies-and-relationships.html#case-study-4-soils" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="bivariate-dependencies-and-relationships.html#cb44-1" aria-hidden="true" tabindex="-1"></a>baker <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/baker.csv&quot;</span>)</span></code></pre></div>
<pre><code>## Rows: 215 Columns: 13
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## dbl (13): X, Y, Corn97BU, B, Ca, Cu, Fe, K, Mg, Mn, Na, P, Zn
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="bivariate-dependencies-and-relationships.html#cb46-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(baker, <span class="fu">aes</span>(<span class="at">x=</span>B, <span class="at">y=</span>Corn97BU)) <span class="sc">+</span></span>
<span id="cb46-2"><a href="bivariate-dependencies-and-relationships.html#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb46-3"><a href="bivariate-dependencies-and-relationships.html#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Boron (ppm)&quot;</span>) <span class="sc">+</span></span>
<span id="cb46-4"><a href="bivariate-dependencies-and-relationships.html#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Corn Yield (bushells)&quot;</span>) </span>
<span id="cb46-5"><a href="bivariate-dependencies-and-relationships.html#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggMarginal</span>(p, <span class="at">type=</span><span class="st">&quot;density&quot;</span>)</span></code></pre></div>
<p><img src="eda-book_files/figure-html/baker-1.png" width="80%" /></p>
<p>Interplay between skewness and association</p>
<p>Data is from a soil chemical analysis of a farm field in Iowa. Is there a relationship between Yield and Boron?</p>
<p>You can get a marginal plot of each variable added to the scatterplot using <code>ggMarginal</code>. This is useful for assessing the skewness in each variable.</p>
<p>Boron is right-skewed Yield is left-skewed. With skewed distributions in marginal variables it is .monash-orange2[hard] to assess the relationship between the two. Make a transformation to fix, first.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="bivariate-dependencies-and-relationships.html#cb47-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(baker, </span>
<span id="cb47-2"><a href="bivariate-dependencies-and-relationships.html#cb47-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x=</span>B, <span class="at">y=</span>Corn97BU<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">+</span> <span class="co">#&lt;&lt;</span></span>
<span id="cb47-3"><a href="bivariate-dependencies-and-relationships.html#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb47-4"><a href="bivariate-dependencies-and-relationships.html#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;log Boron (ppm)&quot;</span>) <span class="sc">+</span></span>
<span id="cb47-5"><a href="bivariate-dependencies-and-relationships.html#cb47-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Corn Yield^2 (bushells)&quot;</span>) <span class="sc">+</span></span>
<span id="cb47-6"><a href="bivariate-dependencies-and-relationships.html#cb47-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="co">#&lt;&lt;</span></span>
<span id="cb47-7"><a href="bivariate-dependencies-and-relationships.html#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggMarginal</span>(p, <span class="at">type=</span><span class="st">&quot;density&quot;</span>) <span class="co">#&lt;&lt;</span></span></code></pre></div>
<p><img src="eda-book_files/figure-html/transfbaker-1.png" width="80%" /></p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="bivariate-dependencies-and-relationships.html#cb48-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(baker, </span>
<span id="cb48-2"><a href="bivariate-dependencies-and-relationships.html#cb48-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x=</span>Fe, <span class="at">y=</span>Corn97BU<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">+</span> </span>
<span id="cb48-3"><a href="bivariate-dependencies-and-relationships.html#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density2d</span>(<span class="at">colour=</span><span class="st">&quot;orange&quot;</span>) <span class="sc">+</span></span>
<span id="cb48-4"><a href="bivariate-dependencies-and-relationships.html#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb48-5"><a href="bivariate-dependencies-and-relationships.html#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Iron (ppm)&quot;</span>) <span class="sc">+</span><span class="co">#&lt;&lt;</span></span>
<span id="cb48-6"><a href="bivariate-dependencies-and-relationships.html#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Corn Yield^2 (bushells)&quot;</span>) </span>
<span id="cb48-7"><a href="bivariate-dependencies-and-relationships.html#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggMarginal</span>(p, <span class="at">type=</span><span class="st">&quot;density&quot;</span>) </span></code></pre></div>
<p><img src="eda-book_files/figure-html/bakeriron-1.png" width="80%" /></p>
<p>Lurking variable?</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="bivariate-dependencies-and-relationships.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(baker, <span class="fu">aes</span>(<span class="at">x=</span>Fe, <span class="at">y=</span>Corn97BU<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb49-2"><a href="bivariate-dependencies-and-relationships.html#cb49-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">colour=</span><span class="fu">ifelse</span>(Ca<span class="sc">&gt;</span><span class="dv">5200</span>, <span class="co">#&lt;&lt;</span></span>
<span id="cb49-3"><a href="bivariate-dependencies-and-relationships.html#cb49-3" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;high&quot;</span>, <span class="st">&quot;low&quot;</span>))) <span class="sc">+</span> <span class="co">#&lt;&lt;</span></span>
<span id="cb49-4"><a href="bivariate-dependencies-and-relationships.html#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb49-5"><a href="bivariate-dependencies-and-relationships.html#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Iron (ppm)&quot;</span>) <span class="sc">+</span></span>
<span id="cb49-6"><a href="bivariate-dependencies-and-relationships.html#cb49-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Corn Yield^2 (bushells)&quot;</span>) <span class="sc">+</span></span>
<span id="cb49-7"><a href="bivariate-dependencies-and-relationships.html#cb49-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_brewer</span>(<span class="st">&quot;&quot;</span>, <span class="at">palette=</span><span class="st">&quot;Dark2&quot;</span>) <span class="sc">+</span></span>
<span id="cb49-8"><a href="bivariate-dependencies-and-relationships.html#cb49-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio=</span><span class="dv">1</span>, </span>
<span id="cb49-9"><a href="bivariate-dependencies-and-relationships.html#cb49-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb49-10"><a href="bivariate-dependencies-and-relationships.html#cb49-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.direction =</span> <span class="st">&quot;horizontal&quot;</span>)</span></code></pre></div>
<p><img src="eda-book_files/figure-html/bakerironca-1.png" width="100%" /></p>
<p>Colour high calcium (&gt;5200ppm) calcium values</p>
<p>If calcium levels in the soil are high, yield is consistently high. If calcium levels are low, then there is a positive relationship between yield and iron, with higher iron leading to higher yields.</p>
</div>
<div id="case-study-5-covid" class="section level2 hasAnchor" number="5.9">
<h2><span class="header-section-number">5.9</span> Case study 5: COVID<a href="bivariate-dependencies-and-relationships.html#case-study-5-covid" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="bivariate-dependencies-and-relationships.html#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read data</span></span>
<span id="cb50-2"><a href="bivariate-dependencies-and-relationships.html#cb50-2" aria-hidden="true" tabindex="-1"></a>nyt_county <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/nytimes/covid-19-data/master/us-counties.csv&quot;</span>)</span>
<span id="cb50-3"><a href="bivariate-dependencies-and-relationships.html#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="bivariate-dependencies-and-relationships.html#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Add centroid lat/long</span></span>
<span id="cb50-5"><a href="bivariate-dependencies-and-relationships.html#cb50-5" aria-hidden="true" tabindex="-1"></a>geoCounty_new <span class="ot">&lt;-</span> geoCounty <span class="sc">%&gt;%</span> <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb50-6"><a href="bivariate-dependencies-and-relationships.html#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fips =</span> <span class="fu">as.character</span>(fips),</span>
<span id="cb50-7"><a href="bivariate-dependencies-and-relationships.html#cb50-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">county =</span> <span class="fu">as.character</span>(county),</span>
<span id="cb50-8"><a href="bivariate-dependencies-and-relationships.html#cb50-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">state =</span> <span class="fu">as.character</span>(state)) <span class="sc">%&gt;%</span></span>
<span id="cb50-9"><a href="bivariate-dependencies-and-relationships.html#cb50-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(fips, lon, lat)</span>
<span id="cb50-10"><a href="bivariate-dependencies-and-relationships.html#cb50-10" aria-hidden="true" tabindex="-1"></a>nyt_county_total <span class="ot">&lt;-</span> nyt_county <span class="sc">%&gt;%</span> </span>
<span id="cb50-11"><a href="bivariate-dependencies-and-relationships.html#cb50-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fips) <span class="sc">%&gt;%</span></span>
<span id="cb50-12"><a href="bivariate-dependencies-and-relationships.html#cb50-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(date <span class="sc">==</span> <span class="fu">max</span>(date)) <span class="sc">%&gt;%</span></span>
<span id="cb50-13"><a href="bivariate-dependencies-and-relationships.html#cb50-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(geoCounty_new, <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;fips&quot;</span><span class="ot">=</span><span class="st">&quot;fips&quot;</span>))</span>
<span id="cb50-14"><a href="bivariate-dependencies-and-relationships.html#cb50-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-15"><a href="bivariate-dependencies-and-relationships.html#cb50-15" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(nyt_county_total, <span class="at">file=</span><span class="st">&quot;../data/nyt_covid.rda&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="bivariate-dependencies-and-relationships.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;data/nyt_covid.rda&quot;</span>)</span>
<span id="cb51-2"><a href="bivariate-dependencies-and-relationships.html#cb51-2" aria-hidden="true" tabindex="-1"></a>usa <span class="ot">&lt;-</span> <span class="fu">map_data</span>(<span class="st">&quot;state&quot;</span>)</span>
<span id="cb51-3"><a href="bivariate-dependencies-and-relationships.html#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb51-4"><a href="bivariate-dependencies-and-relationships.html#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="at">data=</span>usa, </span>
<span id="cb51-5"><a href="bivariate-dependencies-and-relationships.html#cb51-5" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x=</span>long, <span class="at">y=</span>lat, <span class="at">group=</span>group), </span>
<span id="cb51-6"><a href="bivariate-dependencies-and-relationships.html#cb51-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill=</span><span class="st">&quot;grey90&quot;</span>, <span class="at">colour=</span><span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb51-7"><a href="bivariate-dependencies-and-relationships.html#cb51-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span>nyt_county_total, </span>
<span id="cb51-8"><a href="bivariate-dependencies-and-relationships.html#cb51-8" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span>lon, <span class="at">y=</span>lat, <span class="at">size=</span>cases), </span>
<span id="cb51-9"><a href="bivariate-dependencies-and-relationships.html#cb51-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">colour=</span><span class="st">&quot;red&quot;</span>, <span class="at">shape=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb51-10"><a href="bivariate-dependencies-and-relationships.html#cb51-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span>nyt_county_total, </span>
<span id="cb51-11"><a href="bivariate-dependencies-and-relationships.html#cb51-11" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span>lon, <span class="at">y=</span>lat, <span class="at">size=</span>cases), </span>
<span id="cb51-12"><a href="bivariate-dependencies-and-relationships.html#cb51-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">colour=</span><span class="st">&quot;red&quot;</span>, <span class="at">fill=</span><span class="st">&quot;red&quot;</span>, <span class="at">alpha=</span><span class="fl">0.1</span>, <span class="at">shape=</span><span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb51-13"><a href="bivariate-dependencies-and-relationships.html#cb51-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size</span>(<span class="st">&quot;&quot;</span>, <span class="at">range=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">30</span>)) <span class="sc">+</span> </span>
<span id="cb51-14"><a href="bivariate-dependencies-and-relationships.html#cb51-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_map</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 177 rows containing missing values (`geom_point()`).
## Removed 177 rows containing missing values (`geom_point()`).</code></pre>
<p><img src="eda-book_files/figure-html/usacovid-1.png" width="60%" /></p>
<p>Bubble plots, size of point is mapped to another variable.</p>
<p>This bubble plot here shows total count of COVID-19 incidence (as of Aug 30, 2020) for every county in the USA, inspired by the <a href="https://www.nytimes.com/news-event/coronavirus">New York Times coverage</a>.</p>
<p>Where has COVID-19 hit the hardest?
<br></p>
<p>Where are there more people?
<br></p>
<p>This plot tells you NOTHING except where the population centres are in the USA. To understand relative incidence/risk, report COVID numbers relative the population. For example, number of cases per 100,000 people.</p>
</div>
<div id="beyond-quantitative-variables" class="section level2 hasAnchor" number="5.10">
<h2><span class="header-section-number">5.10</span> Beyond quantitative variables<a href="bivariate-dependencies-and-relationships.html#beyond-quantitative-variables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The type of variable determines the choice of mapping.</p>
<ul>
<li>Continuous and categorical <span class="math inline">\(\longrightarrow\)</span> side-by-side boxplots, side-by-side density plots</li>
<li>Both categorical <span class="math inline">\(\longrightarrow\)</span> faceted bar charts, stacked bar charts, mosaic plots, double decker plots</li>
</ul>
</div>
<div id="simpsons-paradox" class="section level2 hasAnchor" number="5.11">
<h2><span class="header-section-number">5.11</span> Simpsons paradox<a href="bivariate-dependencies-and-relationships.html#simpsons-paradox" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>There is an additional variable, which if used for conditioning, changes the association between the variables, you have a paradox 🙃.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="bivariate-dependencies-and-relationships.html#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2222</span>)</span>
<span id="cb53-2"><a href="bivariate-dependencies-and-relationships.html#cb53-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">500</span>)<span class="sc">*</span><span class="fl">0.2</span>, <span class="fu">runif</span>(<span class="dv">300</span>)<span class="sc">+</span><span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-3"><a href="bivariate-dependencies-and-relationships.html#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y1=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>x[<span class="dv">1</span><span class="sc">:</span><span class="dv">500</span>]<span class="sc">+</span><span class="fu">rnorm</span>(<span class="dv">500</span>), </span>
<span id="cb53-4"><a href="bivariate-dependencies-and-relationships.html#cb53-4" aria-hidden="true" tabindex="-1"></a>              <span class="dv">3</span><span class="sc">*</span>x[<span class="dv">501</span><span class="sc">:</span><span class="dv">800</span>] <span class="sc">+</span> <span class="fu">rexp</span>(<span class="dv">300</span>)), </span>
<span id="cb53-5"><a href="bivariate-dependencies-and-relationships.html#cb53-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">y2=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;A&quot;</span>, <span class="dv">500</span>), <span class="fu">rep</span>(<span class="st">&quot;B&quot;</span>, <span class="dv">300</span>)))</span></code></pre></div>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="bivariate-dependencies-and-relationships.html#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y1)) <span class="sc">+</span></span>
<span id="cb54-2"><a href="bivariate-dependencies-and-relationships.html#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb54-3"><a href="bivariate-dependencies-and-relationships.html#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x=</span><span class="dv">0</span>, <span class="at">y=</span><span class="dv">8</span>, <span class="at">label=</span><span class="fu">paste0</span>(<span class="st">&quot;r = &quot;</span>, <span class="fu">round</span>(<span class="fu">cor</span>(df<span class="sc">$</span>x,df<span class="sc">$</span>y1), <span class="dv">2</span>))) <span class="sc">+</span></span>
<span id="cb54-4"><a href="bivariate-dependencies-and-relationships.html#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() </span></code></pre></div>
<p><img src="eda-book_files/figure-html/scat-1.png" width="70%" /></p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="bivariate-dependencies-and-relationships.html#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y1, <span class="at">colour=</span>y2)) <span class="sc">+</span></span>
<span id="cb55-2"><a href="bivariate-dependencies-and-relationships.html#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb55-3"><a href="bivariate-dependencies-and-relationships.html#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_brewer</span>(<span class="st">&quot;&quot;</span>, <span class="at">palette=</span><span class="st">&quot;Dark2&quot;</span>) <span class="sc">+</span></span>
<span id="cb55-4"><a href="bivariate-dependencies-and-relationships.html#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x=</span><span class="dv">0</span>, <span class="at">y=</span><span class="dv">8</span>, <span class="at">label=</span><span class="fu">paste0</span>(<span class="st">&quot;r = &quot;</span>, <span class="fu">round</span>(<span class="fu">cor</span>(df<span class="sc">$</span>x[df<span class="sc">$</span>y2<span class="sc">==</span><span class="st">&quot;A&quot;</span>],df<span class="sc">$</span>y1[df<span class="sc">$</span>y2<span class="sc">==</span><span class="st">&quot;A&quot;</span>]), <span class="dv">2</span>)), <span class="at">colour=</span><span class="st">&quot;forestgreen&quot;</span>) <span class="sc">+</span></span>
<span id="cb55-5"><a href="bivariate-dependencies-and-relationships.html#cb55-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x=</span><span class="fl">1.5</span>, <span class="at">y=</span><span class="dv">0</span>, <span class="at">label=</span><span class="fu">paste0</span>(<span class="st">&quot;r = &quot;</span>, <span class="fu">round</span>(<span class="fu">cor</span>(df<span class="sc">$</span>x[df<span class="sc">$</span>y2<span class="sc">==</span><span class="st">&quot;B&quot;</span>],df<span class="sc">$</span>y1[df<span class="sc">$</span>y2<span class="sc">==</span><span class="st">&quot;B&quot;</span>]), <span class="dv">2</span>)), <span class="at">colour=</span><span class="st">&quot;orangered&quot;</span>) <span class="sc">+</span></span>
<span id="cb55-6"><a href="bivariate-dependencies-and-relationships.html#cb55-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="eda-book_files/figure-html/scatcol-1.png" width="70%" /></p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="bivariate-dependencies-and-relationships.html#cb56-1" aria-hidden="true" tabindex="-1"></a>ucba <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(UCBAdmissions)</span>
<span id="cb56-2"><a href="bivariate-dependencies-and-relationships.html#cb56-2" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(ucba, <span class="fu">aes</span>(Dept)) <span class="sc">+</span></span>
<span id="cb56-3"><a href="bivariate-dependencies-and-relationships.html#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">weight=</span>n))</span>
<span id="cb56-4"><a href="bivariate-dependencies-and-relationships.html#cb56-4" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(ucba, <span class="fu">aes</span>(Admit)) <span class="sc">+</span></span>
<span id="cb56-5"><a href="bivariate-dependencies-and-relationships.html#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">weight=</span>n)) <span class="sc">+</span></span>
<span id="cb56-6"><a href="bivariate-dependencies-and-relationships.html#cb56-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Gender)</span>
<span id="cb56-7"><a href="bivariate-dependencies-and-relationships.html#cb56-7" aria-hidden="true" tabindex="-1"></a>a <span class="sc">+</span> b</span></code></pre></div>
<p><img src="eda-book_files/figure-html/berkeley-1.png" width="90%" /></p>
<p>Did Berkeley .monash-orange2[discriminate] against female applicants?</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="bivariate-dependencies-and-relationships.html#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vcd)</span></code></pre></div>
<pre><code>## Loading required package: grid</code></pre>
<pre><code>## 
## Attaching package: &#39;vcd&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:nullabor&#39;:
## 
##     distplot</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="bivariate-dependencies-and-relationships.html#cb61-1" aria-hidden="true" tabindex="-1"></a>ucba <span class="ot">&lt;-</span> ucba <span class="sc">%&gt;%</span></span>
<span id="cb61-2"><a href="bivariate-dependencies-and-relationships.html#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Admit =</span> <span class="fu">factor</span>(Admit, </span>
<span id="cb61-3"><a href="bivariate-dependencies-and-relationships.html#cb61-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;Rejected&quot;</span>, <span class="st">&quot;Admitted&quot;</span>)),</span>
<span id="cb61-4"><a href="bivariate-dependencies-and-relationships.html#cb61-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">Gender =</span> <span class="fu">factor</span>(Gender, </span>
<span id="cb61-5"><a href="bivariate-dependencies-and-relationships.html#cb61-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;Male&quot;</span>, <span class="st">&quot;Female&quot;</span>),</span>
<span id="cb61-6"><a href="bivariate-dependencies-and-relationships.html#cb61-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;M&quot;</span>,<span class="st">&quot;F&quot;</span>)))</span>
<span id="cb61-7"><a href="bivariate-dependencies-and-relationships.html#cb61-7" aria-hidden="true" tabindex="-1"></a><span class="fu">doubledecker</span>(<span class="fu">xtabs</span>(n<span class="sc">~</span>Dept<span class="sc">+</span>Gender<span class="sc">+</span>Admit, <span class="at">data=</span>ucba),</span>
<span id="cb61-8"><a href="bivariate-dependencies-and-relationships.html#cb61-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fill=</span><span class="fu">c</span>(<span class="st">&quot;grey90&quot;</span>, <span class="st">&quot;orangered&quot;</span>)))</span></code></pre></div>
<p><img src="eda-book_files/figure-html/berkeleydd-1.png" width="100%" /></p>
<p>Based on separately examining each department, there is .monash-orange2[no evidence of discrimination] against female applicants.</p>
</div>
<div id="spurious-association" class="section level2 hasAnchor" number="5.12">
<h2><span class="header-section-number">5.12</span> Spurious association<a href="bivariate-dependencies-and-relationships.html#spurious-association" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="checking-association-with-permutations" class="section level2 hasAnchor" number="5.13">
<h2><span class="header-section-number">5.13</span> Checking association with permutations<a href="bivariate-dependencies-and-relationships.html#checking-association-with-permutations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="bivariate-dependencies-and-relationships.html#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">lineup</span>(<span class="fu">null_permute</span>(<span class="st">&quot;Corn97BU&quot;</span>), baker, <span class="at">n=</span><span class="dv">12</span>), </span>
<span id="cb62-2"><a href="bivariate-dependencies-and-relationships.html#cb62-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span>B, <span class="at">y=</span>Corn97BU)) <span class="sc">+</span></span>
<span id="cb62-3"><a href="bivariate-dependencies-and-relationships.html#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb62-4"><a href="bivariate-dependencies-and-relationships.html#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>.sample, <span class="at">ncol=</span><span class="dv">4</span>)</span></code></pre></div>
<pre><code>## decrypt(&quot;CLg7 X161 sO bJws6sJO qR&quot;)</code></pre>
<p><img src="eda-book_files/figure-html/soils-lineup-1.png" width="60%" /></p>
<p>11 of the panels have had the association broken by permuting one variable. There is no association in these data sets, and hence plots. Does the data plot stand out as being different from the null (no association) plots?</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="bivariate-dependencies-and-relationships.html#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(oly12, <span class="at">package =</span> <span class="st">&quot;VGAMdata&quot;</span>) </span>
<span id="cb64-2"><a href="bivariate-dependencies-and-relationships.html#cb64-2" aria-hidden="true" tabindex="-1"></a>oly12_sub <span class="ot">&lt;-</span> oly12 <span class="sc">%&gt;%</span></span>
<span id="cb64-3"><a href="bivariate-dependencies-and-relationships.html#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Sport <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Swimming&quot;</span>, <span class="st">&quot;Archery&quot;</span>,</span>
<span id="cb64-4"><a href="bivariate-dependencies-and-relationships.html#cb64-4" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;Hockey&quot;</span>, <span class="st">&quot;Tennis&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb64-5"><a href="bivariate-dependencies-and-relationships.html#cb64-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Sex <span class="sc">==</span> <span class="st">&quot;F&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-6"><a href="bivariate-dependencies-and-relationships.html#cb64-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Sport =</span> <span class="fu">fct_drop</span>(Sport), <span class="at">Sex=</span><span class="fu">fct_drop</span>(Sex)) </span>
<span id="cb64-7"><a href="bivariate-dependencies-and-relationships.html#cb64-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-8"><a href="bivariate-dependencies-and-relationships.html#cb64-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">lineup</span>(<span class="fu">null_permute</span>(<span class="st">&quot;Sport&quot;</span>), oly12_sub, <span class="at">n=</span><span class="dv">12</span>),</span>
<span id="cb64-9"><a href="bivariate-dependencies-and-relationships.html#cb64-9" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span>Height, <span class="at">y=</span>Weight, <span class="at">colour=</span>Sport)) <span class="sc">+</span> </span>
<span id="cb64-10"><a href="bivariate-dependencies-and-relationships.html#cb64-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>, <span class="at">se=</span><span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb64-11"><a href="bivariate-dependencies-and-relationships.html#cb64-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_brewer</span>(<span class="st">&quot;&quot;</span>, <span class="at">palette=</span><span class="st">&quot;Dark2&quot;</span>) <span class="sc">+</span></span>
<span id="cb64-12"><a href="bivariate-dependencies-and-relationships.html#cb64-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>.sample, <span class="at">ncol=</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb64-13"><a href="bivariate-dependencies-and-relationships.html#cb64-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<pre><code>## decrypt(&quot;CLg7 X161 sO bJws6sJO vj&quot;)</code></pre>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<pre><code>## Warning: Removed 276 rows containing non-finite values (`stat_smooth()`).</code></pre>
<p><img src="eda-book_files/figure-html/oly-lineup-1.png" width="60%" /></p>
<p>11 of the panels have had the association broken by permuting the Sport label. There is no difference in the association between weight and height across sports in these data sets, and hence plots. Does the data plot stand out as being different from the null (no association difference between sports) plots?</p>
</div>
<div id="resources" class="section level2 hasAnchor" number="5.14">
<h2><span class="header-section-number">5.14</span> Resources<a href="bivariate-dependencies-and-relationships.html#resources" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Friendly and Denis “Milestones in History of Thematic Cartography, Statistical Graphics and Data Visualisation” available at <a href="http://www.datavis.ca/milestones/" class="uri">http://www.datavis.ca/milestones/</a></li>
<li>Unwin (2015) <a href="http://www.gradaanwr.net">Graphical Data Analysis with R</a></li>
<li>Graphics using <a href="https://ggplot2.tidyverse.org">ggplot2</a></li>
<li>Wilke (2019) Fundamentals of Data Visualization <a href="https://clauswilke.com/dataviz/" class="uri">https://clauswilke.com/dataviz/</a></li>
</ul>
</div>
<div id="exercises-1" class="section level2 hasAnchor" number="5.15">
<h2><span class="header-section-number">5.15</span> Exercises<a href="bivariate-dependencies-and-relationships.html#exercises-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>For each of the following scatterplots, of different Olympic athlete’s height and weight identify the visible features, and which is the most surprising.</li>
</ol>
<p><img src="eda-book_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<!--
a. positive linear association, discreteness. Most surprising is the discreteness, probably due to weight limits on competition groups.
b. positive linear association, discreteness in both x and y, hint of clumpiness, increasing variance as both x and y increase. Probably the most surprising is the discreteness in both directions. Is there a height limit for some roles on the boat?
c. positive linear association, outlier. The outlier is the most surprising it is a tall and extra heavy archer.
d. positive linear association, clumpiness. Probably some positions in the crew are smaller people, the coxswain. 
-->
<ol start="2" style="list-style-type: decimal">
<li><p>Guess the correlation between the two variables in each of the previous scatterplots.</p></li>
<li><p>From the following scatterplot, of diamond size and price, what are the most prominent features?</p></li>
</ol>
<p><img src="eda-book_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<!--
positive nonlinear association, heteroskedasticity, outliers, gaps or clumping.
-->
<ol start="4" style="list-style-type: decimal">
<li>In the previous plot of diamonds, what transformation would be recommended based on the “circle of transformations”?</li>
</ol>
<!-- transform price, down the ladder of powere -->
<ol start="5" style="list-style-type: decimal">
<li>In the following plot of arrival delay and departure delay of flights into and out of the New York City area, what are the most prominent features?</li>
</ol>
<p><img src="eda-book_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<!--
strong positive association, barrier (arrival delays are not possible to be less than some function of departure delays, might depend on length of flight), heteroskedastic
-->
<ol start="6" style="list-style-type: decimal">
<li>Which of these would be a surprising feature learned from this plot? Why?</li>
</ol>
<ul>
<li>There are negative departure and arrival delays <!-- A bit surprising, but mostly these are small, so some flights leave a fraction early which could happen if all passengers are on board. Early arriving flights are common. --></li>
<li>If a flight has a delay in departure it likely will be delayed on arrival <!-- Not surprising, because most likely a flight will be delayed arriving if it started late. --></li>
<li>Some flights with negative departure delay have long arrival delays <!-- This is the most surprising, because it means a flight left early but arrived quite late. Physics-wise an early departure should lead to an early arrival. So it makes one think about how the flight could arrive quite late: diverted to avoid a storm, or sat on tarmac after pushing back from gate, or before getting to gate. Requires you to know that departure and arrival times are from and to the gate. --></li>
<li>Some flights have long delays <!-- This is reasonably common so it's not surprising.--></li>
<li>Some flights with negative arrival delays have positive departure delays <!-- Not so surprising, because a plane can catch up to schedule in-flight. --></li>
</ul>
<ol start="7" style="list-style-type: decimal">
<li>A dominant feature in the plot of average rating by number of ratings of movies in the IMDB database is a barrier, or two barriers, both top and bottom of plot. What is a plausible explanation for this feature?</li>
</ol>
<p><img src="eda-book_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<ul>
<li>As movies become more popular ratings invariably go down <!-- This makes no sense. If it's popular then it will be mostly rated highly. --></li>
<li>There are just very few frequently rated movies and this means it is unlikely to see high values. <!-- A nonsense statement --></li>
<li>The lesser rated movies have a lot of variance in their ratings, producing a barrier for the more frequently rated movies. <!-- We could remove the lesser rates movies, and the barrier for frequently rated movies would still exist. --></li>
<li>The lesser rated movies have a lot of variance in their ratings, producing a barrier for the more frequently rated movies. <!-- Generally, it is the case that skewness will appear in a plot as less variance in the sparser plot regions. But that is not the pattern causing the barrier in the movies plot. --></li>
<li>The average of many values tends to be unlikely to be at the highest and lowest possible values. <!-- This is correct, is a number crunching phenomenon, regression to the mean (?)  --></li>
</ul>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-friendly_denis" class="csl-entry">
Friendly, M., and D. J. Denis. 2001. <span>“Milestones in the History of Thematic Cartography, Statistical Graphics, and Data Visualization.”</span> <a href="http://www.datavis.ca/milestones/" class="uri">http://www.datavis.ca/milestones/</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="working-with-a-single-variable.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="going-beyond-two-variables.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["eda-book.pdf", "eda-book.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
